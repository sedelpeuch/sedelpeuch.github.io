<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Sébastien Delpeuch's Blog</title>
        <link>https://delpeuch.net/pr-preview/pr-15/blog</link>
        <description>Sébastien Delpeuch Blog</description>
        <lastBuildDate>Sat, 15 Feb 2025 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Secrets et ConfigMaps dans Kubernetes]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps</guid>
            <pubDate>Sat, 15 Feb 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Découvrez les concepts de Secrets et ConfigMaps dans Kubernetes, et comment les utiliser pour gérer les configurations et les informations sensibles.]]></description>
            <content:encoded><![CDATA[<p>Kubernetes offre des mécanismes pour gérer les configurations et les informations sensibles de manière sécurisée et efficace. Dans cet article, nous allons explorer les concepts de Secrets et ConfigMaps dans Kubernetes, et comment les utiliser pour gérer les configurations et les informations sensibles.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configmap">ConfigMap<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#configmap" class="hash-link" aria-label="Direct link to ConfigMap" title="Direct link to ConfigMap">​</a></h2>
<p>Un ConfigMap est une ressource Kubernetes utilisée pour stocker des paires clé-valeur de configuration. Les ConfigMaps permettent de séparer les configurations des conteneurs, ce qui facilite la gestion et la mise à jour des configurations sans avoir à reconstruire les images des conteneurs.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-configmap">Exemple de ConfigMap<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#exemple-de-configmap" class="hash-link" aria-label="Direct link to Exemple de ConfigMap" title="Direct link to Exemple de ConfigMap">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">data</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">database_url</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"postgres://user:password@hostname:5432/dbname"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">log_level</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"debug"</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-dun-configmap-dans-un-pod">Utilisation d'un ConfigMap dans un Pod<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#utilisation-dun-configmap-dans-un-pod" class="hash-link" aria-label="Direct link to Utilisation d'un ConfigMap dans un Pod" title="Direct link to Utilisation d'un ConfigMap dans un Pod">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">env</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> DATABASE_URL</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">valueFrom</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">configMapKeyRef</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">key</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> database_url</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> LOG_LEVEL</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">valueFrom</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">configMapKeyRef</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">key</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> log_level</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="secret">Secret<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#secret" class="hash-link" aria-label="Direct link to Secret" title="Direct link to Secret">​</a></h2>
<p>Un Secret est une ressource Kubernetes utilisée pour stocker des informations sensibles, telles que des mots de passe, des clés API et des certificats. Les Secrets permettent de gérer les informations sensibles de manière sécurisée et de les injecter dans les conteneurs sans les exposer dans les fichiers de configuration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-secret">Exemple de Secret<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#exemple-de-secret" class="hash-link" aria-label="Direct link to Exemple de Secret" title="Direct link to Exemple de Secret">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">type</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Opaque</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">data</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">username</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> dXNlcm5hbWU=</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">password</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> cGFzc3dvcmQ=</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-dun-secret-dans-un-pod">Utilisation d'un Secret dans un Pod<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#utilisation-dun-secret-dans-un-pod" class="hash-link" aria-label="Direct link to Utilisation d'un Secret dans un Pod" title="Direct link to Utilisation d'un Secret dans un Pod">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">env</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> USERNAME</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">valueFrom</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">secretKeyRef</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">key</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> username</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> PASSWORD</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">valueFrom</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">secretKeyRef</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">key</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> password</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/15/06-orchestration/k8s-secrets-configmaps#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Les Secrets et ConfigMaps dans Kubernetes permettent de gérer les configurations et les informations sensibles de manière sécurisée et efficace. En utilisant ces ressources, vous pouvez séparer les configurations des conteneurs, faciliter la gestion des configurations et protéger les informations sensibles.</p>
<p>Pour en savoir plus sur Kubernetes, consultez la <a href="https://kubernetes.io/fr/docs/concepts/" target="_blank" rel="noopener noreferrer">documentation officielle</a>.</p>]]></content:encoded>
            <category>Kubernetes</category>
            <category>Orchestration</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Stockage dans Kubernetes]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage</guid>
            <pubDate>Mon, 10 Feb 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Découvrez les concepts de stockage dans Kubernetes, tels que PersistentVolume, PersistentVolumeClaim, StorageClass et Volume.]]></description>
            <content:encoded><![CDATA[<p>Kubernetes offre des mécanismes pour monter et utiliser du stockage dans les pods, mais la gestion des données, y compris la provision, la sauvegarde et la réplication, est une tâche qui incombe aux administrateurs du cluster. Dans cet article, nous allons explorer les concepts de stockage dans Kubernetes, notamment PersistentVolume, PersistentVolumeClaim, StorageClass et Volume.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="persistentvolume-pv">PersistentVolume (PV)<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#persistentvolume-pv" class="hash-link" aria-label="Direct link to PersistentVolume (PV)" title="Direct link to PersistentVolume (PV)">​</a></h2>
<p>Un PersistentVolume (PV) est une ressource Kubernetes qui représente un volume de stockage dans le cluster. Il peut être provisionné dynamiquement ou statiquement et est utilisé pour stocker des données de manière persistante. Les PVs sont indépendants des pods et peuvent être réclamés par des PersistentVolumeClaims (PVCs).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-persistentvolume">Exemple de PersistentVolume<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#exemple-de-persistentvolume" class="hash-link" aria-label="Direct link to Exemple de PersistentVolume" title="Direct link to Exemple de PersistentVolume">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> PersistentVolume</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pv</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">capacity</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">storage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> 1Gi</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">accessModes</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> ReadWriteOnce</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">persistentVolumeReclaimPolicy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Retain</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">storageClassName</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">class</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">hostPath</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> /mnt/data</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="persistentvolumeclaim-pvc">PersistentVolumeClaim (PVC)<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#persistentvolumeclaim-pvc" class="hash-link" aria-label="Direct link to PersistentVolumeClaim (PVC)" title="Direct link to PersistentVolumeClaim (PVC)">​</a></h2>
<p>Un PersistentVolumeClaim (PVC) est une ressource Kubernetes utilisée par les pods pour demander un certain type et une certaine quantité de stockage persistant. Les PVCs sont liés aux PVs disponibles dans le cluster.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-persistentvolumeclaim">Exemple de PersistentVolumeClaim<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#exemple-de-persistentvolumeclaim" class="hash-link" aria-label="Direct link to Exemple de PersistentVolumeClaim" title="Direct link to Exemple de PersistentVolumeClaim">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> PersistentVolumeClaim</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pvc</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">accessModes</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> ReadWriteOnce</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">resources</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">requests</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">storage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> 1Gi</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">storageClassName</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">class</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="storageclass">StorageClass<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#storageclass" class="hash-link" aria-label="Direct link to StorageClass" title="Direct link to StorageClass">​</a></h2>
<p>Une StorageClass est une ressource Kubernetes utilisée pour définir les types de stockage disponibles dans le cluster. Elle permet de provisionner dynamiquement des PersistentVolumes en fonction des besoins spécifiques des applications.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-storageclass">Exemple de StorageClass<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#exemple-de-storageclass" class="hash-link" aria-label="Direct link to Exemple de StorageClass" title="Direct link to Exemple de StorageClass">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> storage.k8s.io/v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> StorageClass</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">storage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">class</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">provisioner</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> kubernetes.io/no</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">provisioner</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumeBindingMode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> WaitForFirstConsumer</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volume">Volume<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#volume" class="hash-link" aria-label="Direct link to Volume" title="Direct link to Volume">​</a></h2>
<p>Un Volume Kubernetes est un répertoire, potentiellement monté à partir du stockage du nœud, partagé entre les conteneurs d'un pod. Les volumes sont utilisés pour stocker des données de manière temporaire ou persistante.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-volume">Exemple de Volume<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#exemple-de-volume" class="hash-link" aria-label="Direct link to Exemple de Volume" title="Direct link to Exemple de Volume">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumeMounts</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">mountPath</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> /usr/share/nginx/html</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumes</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">persistentVolumeClaim</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">claimName</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pvc</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/10/06-orchestration/k8s-storage#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Les concepts de stockage dans Kubernetes, tels que PersistentVolume, PersistentVolumeClaim, StorageClass et Volume, permettent de gérer efficacement le stockage des données dans les applications conteneurisées. En comprenant ces concepts, vous serez en mesure de tirer parti de la puissance de Kubernetes pour gérer le stockage de vos applications.</p>
<p>Pour en savoir plus sur Kubernetes, consultez la <a href="https://kubernetes.io/fr/docs/concepts/" target="_blank" rel="noopener noreferrer">documentation officielle</a>.</p>]]></content:encoded>
            <category>Kubernetes</category>
            <category>Orchestration</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Composants de base de Kubernetes]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components</guid>
            <pubDate>Wed, 05 Feb 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Découvrez les composants de base de Kubernetes, tels que les Services, Pods, Deployments et StatefulSets.]]></description>
            <content:encoded><![CDATA[<p>Kubernetes est une plateforme d'orchestration de conteneurs qui permet de gérer des clusters de machines exécutant des conteneurs. Dans cet article, nous allons explorer les composants de base de Kubernetes, notamment les Services, Pods, Deployments et StatefulSets.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pod">Pod<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#pod" class="hash-link" aria-label="Direct link to Pod" title="Direct link to Pod">​</a></h2>
<p>Un Pod est l'unité de base de déploiement dans Kubernetes. Il représente un ou plusieurs conteneurs qui partagent le même réseau et le même espace de stockage. Les Pods sont éphémères et peuvent être recréés en cas de défaillance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-pod">Exemple de Pod<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#exemple-de-pod" class="hash-link" aria-label="Direct link to Exemple de Pod" title="Direct link to Exemple de Pod">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containerPort</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">80</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="service">Service<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#service" class="hash-link" aria-label="Direct link to Service" title="Direct link to Service">​</a></h2>
<p>Un Service est une abstraction qui permet d'exposer une application exécutée sur un ensemble de Pods en tant que service réseau. Les Services permettent de distribuer le trafic réseau entre les Pods et de garantir la haute disponibilité des applications.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-service">Exemple de Service<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#exemple-de-service" class="hash-link" aria-label="Direct link to Exemple de Service" title="Direct link to Exemple de Service">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">selector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">protocol</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> TCP</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">port</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">targetPort</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">type</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> LoadBalancer</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">​</a></h2>
<p>Un Deployment est un objet Kubernetes qui gère le déploiement et la mise à l'échelle des applications conteneurisées. Il définit l'état souhaité de l'application et Kubernetes s'occupe de créer et de gérer les instances (Pods) pour atteindre cet état.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-deployment">Exemple de Deployment<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#exemple-de-deployment" class="hash-link" aria-label="Direct link to Exemple de Deployment" title="Direct link to Exemple de Deployment">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">replicas</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">selector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">matchLabels</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">template</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">labels</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containerPort</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">80</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="statefulset">StatefulSet<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#statefulset" class="hash-link" aria-label="Direct link to StatefulSet" title="Direct link to StatefulSet">​</a></h2>
<p>Un StatefulSet est un objet Kubernetes qui gère le déploiement et la mise à l'échelle des applications avec état. Contrairement aux Deployments, les StatefulSets garantissent l'ordre et l'unicité des Pods, ce qui est essentiel pour les applications nécessitant un stockage persistant.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-statefulset">Exemple de StatefulSet<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#exemple-de-statefulset" class="hash-link" aria-label="Direct link to Exemple de StatefulSet" title="Direct link to Exemple de StatefulSet">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">apiVersion</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">kind</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> StatefulSet</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">statefulset</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">serviceName</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"my-service"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">replicas</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">selector</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">matchLabels</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">template</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">labels</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containers</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">containerPort</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumeMounts</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">mountPath</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> /usr/share/nginx/html</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumeClaimTemplates</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">spec</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">accessModes</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"ReadWriteOnce"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">resources</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">requests</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">storage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> 1Gi</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/05/06-orchestration/k8s-basic-components#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Les composants de base de Kubernetes, tels que les Pods, Services, Deployments et StatefulSets, permettent de déployer, gérer et mettre à l'échelle des applications conteneurisées de manière efficace. En comprenant ces composants, vous serez en mesure de tirer parti de la puissance de Kubernetes pour gérer vos applications.</p>
<p>Pour en savoir plus sur Kubernetes, consultez la <a href="https://kubernetes.io/fr/docs/concepts/" target="_blank" rel="noopener noreferrer">documentation officielle</a>.</p>]]></content:encoded>
            <category>Kubernetes</category>
            <category>Orchestration</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Introduction à Kubernetes]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction</guid>
            <pubDate>Sat, 01 Feb 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Découvrez les concepts de base de Kubernetes, une plateforme d'orchestration de conteneurs.]]></description>
            <content:encoded><![CDATA[<p>Kubernetes est une plateforme open-source conçue pour automatiser le déploiement, la mise à l'échelle et la gestion des applications conteneurisées. Il permet de regrouper des conteneurs qui composent une application en unités logiques pour une gestion et une découverte plus faciles.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-que-kubernetes-">Qu'est-ce que Kubernetes ?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction#quest-ce-que-kubernetes-" class="hash-link" aria-label="Direct link to Qu'est-ce que Kubernetes ?" title="Direct link to Qu'est-ce que Kubernetes ?">​</a></h2>
<p>Kubernetes, souvent abrégé en K8s, est une plateforme d'orchestration de conteneurs qui permet de gérer des clusters de machines exécutant des conteneurs. Il a été initialement développé par Google et est maintenant maintenu par la Cloud Native Computing Foundation (CNCF).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="architecture-de-kubernetes">Architecture de Kubernetes<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction#architecture-de-kubernetes" class="hash-link" aria-label="Direct link to Architecture de Kubernetes" title="Direct link to Architecture de Kubernetes">​</a></h3>
<p>L'architecture de Kubernetes est composée de plusieurs composants clés :</p>
<ul>
<li><strong>Master Node</strong> : Le nœud maître est responsable de la gestion du cluster. Il orchestre les tâches telles que le déploiement des applications, la maintenance de l'état souhaité des applications, la mise à l'échelle des applications et la mise à jour des applications.</li>
<li><strong>Worker Nodes</strong> : Les nœuds de travail exécutent les applications conteneurisées. Chaque nœud de travail contient les services nécessaires pour exécuter les conteneurs et est géré par le nœud maître.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Architecture de Kubernetes" src="https://delpeuch.net/pr-preview/pr-15/assets/images/k8s-architecture-b792fb99c20256118ec91e912eac62c7.png" width="1403" height="1066" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="composants-principaux-de-kubernetes">Composants principaux de Kubernetes<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction#composants-principaux-de-kubernetes" class="hash-link" aria-label="Direct link to Composants principaux de Kubernetes" title="Direct link to Composants principaux de Kubernetes">​</a></h3>
<ul>
<li><strong>API Server</strong> : L'API Server est le point d'entrée pour toutes les commandes Kubernetes. Il expose l'API Kubernetes.</li>
<li><strong>etcd</strong> : etcd est un magasin de données clé-valeur distribué qui stocke les données de configuration du cluster et l'état du cluster.</li>
<li><strong>Scheduler</strong> : Le Scheduler est responsable de la répartition des conteneurs sur les nœuds de travail en fonction des ressources disponibles et des contraintes définies.</li>
<li><strong>Controller Manager</strong> : Le Controller Manager exécute les contrôleurs qui surveillent l'état du cluster et effectuent les ajustements nécessaires pour atteindre l'état souhaité.</li>
<li><strong>Kubelet</strong> : Kubelet est un agent qui s'exécute sur chaque nœud de travail et garantit que les conteneurs sont exécutés dans un Pod.</li>
<li><strong>Container Runtime</strong> : Le Container Runtime est le logiciel responsable de l'exécution des conteneurs. Kubernetes prend en charge plusieurs runtimes de conteneurs, y compris Docker, containerd et CRI-O.</li>
<li><strong>Kube-proxy</strong> : Kube-proxy est un proxy réseau qui gère la mise en réseau des conteneurs et assure la communication entre les services.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="avantages-de-kubernetes">Avantages de Kubernetes<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction#avantages-de-kubernetes" class="hash-link" aria-label="Direct link to Avantages de Kubernetes" title="Direct link to Avantages de Kubernetes">​</a></h3>
<ul>
<li><strong>Portabilité</strong> : Kubernetes est compatible avec plusieurs environnements de cloud, y compris AWS, Azure et Google Cloud, ainsi qu'avec des environnements sur site.</li>
<li><strong>Scalabilité</strong> : Kubernetes permet de mettre à l'échelle les applications de manière horizontale (en ajoutant plus de réplicas) et verticale (en allouant plus de ressources à un conteneur).</li>
<li><strong>Résilience</strong> : Kubernetes assure la haute disponibilité des applications en redémarrant automatiquement les conteneurs défaillants, en répliquant les conteneurs et en équilibrant la charge du trafic réseau.</li>
<li><strong>Gestion simplifiée</strong> : Kubernetes automatise de nombreuses tâches de gestion des conteneurs, y compris le déploiement, la mise à jour et la mise à l'échelle des applications.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/02/01/06-orchestration/k8s-introduction#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Kubernetes est une plateforme puissante et flexible pour l'orchestration des conteneurs. En automatisant de nombreuses tâches de gestion des conteneurs, Kubernetes permet aux équipes de développement et d'exploitation de se concentrer sur la création et la maintenance des applications, plutôt que sur la gestion de l'infrastructure sous-jacente.</p>
<p>Pour en savoir plus sur Kubernetes, consultez la <a href="https://kubernetes.io/fr/docs/concepts/" target="_blank" rel="noopener noreferrer">documentation officielle</a>.</p>]]></content:encoded>
            <category>Kubernetes</category>
            <category>Orchestration</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Nginx Proxy Manager]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager</guid>
            <pubDate>Sun, 12 Jan 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Présentation de Nginx Proxy Manager, ses fonctionnalités et ses avantages, ainsi qu'une démonstration d'utilisation avec Docker.]]></description>
            <content:encoded><![CDATA[<p>Nginx Proxy Manager est une interface utilisateur graphique (GUI) pour gérer les proxys inverses Nginx. Il simplifie la gestion des proxys inverses, des certificats SSL et des redirections de trafic. Dans cet article, nous allons présenter Nginx Proxy Manager, expliquer ses fonctionnalités et avantages, et fournir une démonstration d'utilisation avec Docker.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-que-nginx-proxy-manager-">Qu'est-ce que Nginx Proxy Manager ?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#quest-ce-que-nginx-proxy-manager-" class="hash-link" aria-label="Direct link to Qu'est-ce que Nginx Proxy Manager ?" title="Direct link to Qu'est-ce que Nginx Proxy Manager ?">​</a></h2>
<p><img decoding="async" loading="lazy" alt="Nginx Proxy Manager" src="https://delpeuch.net/pr-preview/pr-15/assets/images/nginx-proxy-manager-b8f97f3974e56251debc7386ebfee5d7.png" width="1000" height="762" class="img_ev3q"></p>
<p><a href="https://nginxproxymanager.com/" target="_blank" rel="noopener noreferrer">Nginx Proxy Manager</a> est une interface utilisateur graphique (GUI) pour gérer les proxys inverses Nginx. Il permet de configurer facilement des proxys inverses, des certificats SSL et des redirections de trafic. Nginx Proxy Manager est conçu pour être simple à utiliser et accessible aux utilisateurs non techniques.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Qu'est-ce qu'un proxy ?</summary><div><div class="collapsibleContent_i85q"><p>Un proxy, également connu sous le nom de proxy direct ou proxy de transfert, est un serveur qui agit comme un intermédiaire entre un client (par exemple, un utilisateur ou un appareil) et un serveur de destination sur Internet. Voici un aperçu détaillé de son fonctionnement :</p><ol>
<li>
<p><strong>Interception des requêtes</strong> : Lorsqu'un client souhaite accéder à une ressource sur Internet, il envoie une requête au proxy au lieu de se connecter directement au serveur de destination. Le proxy intercepte cette requête.</p>
</li>
<li>
<p><strong>Filtrage et sécurité</strong> : Le proxy examine la requête pour s'assurer qu'elle respecte les politiques de sécurité et de filtrage définies par l'administrateur réseau. Il peut bloquer l'accès à certains sites web, filtrer les contenus inappropriés ou malveillants, et appliquer des règles de sécurité.</p>
</li>
<li>
<p><strong>Anonymisation</strong> : Le proxy peut masquer l'adresse IP du client en utilisant sa propre adresse IP pour se connecter au serveur de destination. Cela permet de protéger l'identité et la confidentialité du client.</p>
</li>
<li>
<p><strong>Mise en cache</strong> : Le proxy peut mettre en cache les réponses des serveurs de destination. Si un autre client demande la même ressource, le proxy peut fournir la réponse mise en cache, ce qui réduit la charge sur le serveur de destination et améliore les temps de réponse.</p>
</li>
<li>
<p><strong>Transmission de la requête</strong> : Si la requête est autorisée, le proxy la transmet au serveur de destination en utilisant sa propre adresse IP. Le serveur de destination répond alors au proxy.</p>
</li>
<li>
<p><strong>Retour de la réponse</strong> : Le proxy reçoit la réponse du serveur de destination, la filtre à nouveau si nécessaire, et la renvoie au client. Le client reçoit ainsi la réponse comme s'il avait directement communiqué avec le serveur de destination.</p>
</li>
</ol></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fonctionnalités-de-nginx-proxy-manager">Fonctionnalités de Nginx Proxy Manager<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#fonctionnalit%C3%A9s-de-nginx-proxy-manager" class="hash-link" aria-label="Direct link to Fonctionnalités de Nginx Proxy Manager" title="Direct link to Fonctionnalités de Nginx Proxy Manager">​</a></h3>
<ul>
<li><strong>Gestion des proxys inverses</strong> : Configurez facilement des proxys inverses pour vos applications web.</li>
<li><strong>Certificats SSL</strong> : Gérez les certificats SSL pour sécuriser vos sites web.</li>
<li><strong>Redirections de trafic</strong> : Configurez des redirections de trafic pour vos domaines et sous-domaines.</li>
<li><strong>Interface utilisateur intuitive</strong> : Utilisez une interface utilisateur graphique pour gérer vos configurations Nginx.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="avantages-de-nginx-proxy-manager">Avantages de Nginx Proxy Manager<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#avantages-de-nginx-proxy-manager" class="hash-link" aria-label="Direct link to Avantages de Nginx Proxy Manager" title="Direct link to Avantages de Nginx Proxy Manager">​</a></h3>
<ul>
<li><strong>Simplicité</strong> : Nginx Proxy Manager simplifie la gestion des proxys inverses et des certificats SSL.</li>
<li><strong>Accessibilité</strong> : L'interface utilisateur graphique rend Nginx Proxy Manager accessible aux utilisateurs non techniques.</li>
<li><strong>Flexibilité</strong> : Nginx Proxy Manager prend en charge une variété de configurations et de scénarios d'utilisation.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-de-nginx-proxy-manager-avec-docker">Utilisation de Nginx Proxy Manager avec Docker<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#utilisation-de-nginx-proxy-manager-avec-docker" class="hash-link" aria-label="Direct link to Utilisation de Nginx Proxy Manager avec Docker" title="Direct link to Utilisation de Nginx Proxy Manager avec Docker">​</a></h2>
<p>Dans cette section, nous allons démontrer comment utiliser Nginx Proxy Manager avec Docker. Nous allons créer un conteneur Docker pour Nginx Proxy Manager et configurer un proxy inverse pour une application web.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prérequis">Prérequis<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#pr%C3%A9requis" class="hash-link" aria-label="Direct link to Prérequis" title="Direct link to Prérequis">​</a></h3>
<ul>
<li>Docker installé sur votre machine</li>
<li>Une application web à proxyfier</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="étapes">Étapes<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#%C3%A9tapes" class="hash-link" aria-label="Direct link to Étapes" title="Direct link to Étapes">​</a></h3>
<ol>
<li>
<p><strong>Créer un fichier <code>docker-compose.yml</code></strong></p>
<p>Créez un fichier <code>docker-compose.yml</code> avec le contenu suivant :</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">version</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'3'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">services</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> your</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">image</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">container_name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> your</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"8080:80"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">nginx-proxy-manager</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> jc21/nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">proxy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">manager</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">container_name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">proxy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">manager</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"80:80"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"81:81"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"443:443"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumes</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> ./data</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">/data</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> ./letsencrypt</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">/etc/letsencrypt</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Démarrer les conteneurs Docker</strong></p>
<p>Exécutez la commande suivante pour démarrer les conteneurs Docker :</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker-compose</span><span class="token plain"> up </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-d</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Accéder à l'interface utilisateur de Nginx Proxy Manager</strong></p>
<p>Ouvrez votre navigateur et accédez à <code>http://localhost:81</code>. Connectez-vous avec les informations d'identification par défaut (<code>admin@example.com</code> / <code>changeme</code>) et changez le mot de passe.</p>
</li>
<li>
<p><strong>Configurer un proxy inverse</strong></p>
<p>Dans l'interface utilisateur de Nginx Proxy Manager, ajoutez un nouveau proxy hôte avec les paramètres suivants :</p>
<ul>
<li><strong>Domain Names</strong> : Entrez le nom de domaine ou l'adresse IP de votre application web.</li>
<li><strong>Forward Hostname / IP</strong> : Entrez <code>app</code>.</li>
<li><strong>Forward Port</strong> : Entrez <code>80</code>.</li>
</ul>
<p>Enregistrez la configuration et accédez à votre application web via le nom de domaine ou l'adresse IP configurée.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/12/02-network/nginx-proxy-manager#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Nginx Proxy Manager est un outil puissant et facile à utiliser pour gérer les proxys inverses Nginx, les certificats SSL et les redirections de trafic. En utilisant Docker, vous pouvez rapidement déployer et configurer Nginx Proxy Manager pour vos applications web. Essayez Nginx Proxy Manager dès aujourd'hui pour simplifier la gestion de vos proxys inverses et améliorer la sécurité de vos sites web.</p>]]></content:encoded>
            <category>nginx-proxy-manager</category>
            <category>Docker</category>
            <category>Network</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[DevOps Roadmap 2025]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2025/01/01/devops-roadmap-2025</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2025/01/01/devops-roadmap-2025</guid>
            <pubDate>Wed, 01 Jan 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Présentation de ma roadmap DevOps personnelle 2025]]></description>
            <content:encoded><![CDATA[<p>Voici un résumé de ma roadmap DevOps personnelle pour 2025. Cette roadmap est basée sur mes expériences et mes objectifs personnels. Elle est sujette à des changements et des mises à jour régulières. N'hésitez pas à me contacter si vous avez des suggestions ou des commentaires.</p>
<!-- -->
<p><img decoding="async" loading="lazy" alt="DevOps" src="https://delpeuch.net/pr-preview/pr-15/assets/images/devops-7e8caa7376b7c423945a1df3b7a1fa48.png" width="446" height="212" class="img_ev3q"></p>
<h2><div style="text-align:center"><span></span><div style="padding:2px 16px"><h2>06 Orchestration de conteneurs - Kubernetes &amp; Docker Swarm</h2></div></div></h2>
<ul>
<li>Apprendre les composants de base comme, Deployment, Service, ConfigMap, Secret, StatefulSet</li>
<li>CLI Kubernetes (Kubectl)</li>
<li>Persistance des données avec les volumes K8s</li>
<li>Externalisation des configurations avec ConfigMap et Secret</li>
<li>Accès aux applications avec les composants Ingress (Nginx)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-1"><div style="text-align:center"><span></span><div style="padding:2px 16px"><h2>07 Monitoring &amp; Observabilité</h2></div></div><a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/01/devops-roadmap-2025#-1" class="hash-link" aria-label="Direct link to -1" title="Direct link to -1">​</a></h2>
<ul>
<li>Grafana : Outil d'analyse et de visualisation interactive</li>
<li>Prometheus : Un outil de surveillance et d'alerte populaire</li>
<li>Loki : Une pile de gestion de logs populaire</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-2"><div style="text-align:center"><span></span><div style="padding:2px 16px"><h2>08 Infrastructure as Code</h2></div></div><a href="https://delpeuch.net/pr-preview/pr-15/blog/2025/01/01/devops-roadmap-2025#-2" class="hash-link" aria-label="Direct link to -2" title="Direct link to -2">​</a></h2>
<ul>
<li>Terraform est l'outil de provisionnement d'infrastructure le plus populaire</li>
<li>Ansible est l'outil de gestion de configuration le plus populaire</li>
</ul>]]></content:encoded>
            <category>Devops</category>
            <category>Roadmap</category>
        </item>
        <item>
            <title><![CDATA[FastAPI]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/12/15/09-scripting/fastapi</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/12/15/09-scripting/fastapi</guid>
            <pubDate>Sun, 15 Dec 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[FastAPI est un framework web moderne et rapide (hautes performances) pour la création d'API avec Python, basé sur les annotations de types standard de Python.]]></description>
            <content:encoded><![CDATA[<p>FastAPI est un framework web moderne et rapide (hautes performances) pour la création d'API avec Python, basé sur les annotations de types standard de Python.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="aperçu">Aperçu<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/12/15/09-scripting/fastapi#aper%C3%A7u" class="hash-link" aria-label="Direct link to Aperçu" title="Direct link to Aperçu">​</a></h2>
<p>FastAPI est un framework web moderne et rapide (hautes performances) pour la création d'API avec Python, basé sur les annotations de types standard de Python. Il offre des performances élevées, comparables à celles de NodeJS et Go, grâce à Starlette et Pydantic, ce qui en fait l'un des frameworks Python les plus rapides disponibles. FastAPI permet d'augmenter la vitesse de développement des fonctionnalités de 200% à 300%, de réduire d'environ 40% les erreurs humaines des développeurs, et propose un excellent support des éditeurs avec des complétions.</p>
<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Site Web</td><td><a href="https://fastapi.tiangolo.com/" target="_blank" rel="noopener noreferrer">https://fastapi.tiangolo.com/</a></td></tr><tr><td>GitHub Stars</td><td>&gt; 75k ⭐</td></tr><tr><td>Nombre de contributeurs</td><td>700</td></tr><tr><td>Licence</td><td>MIT</td></tr></tbody></table>
<ul>
<li>Finalité : Création des API web avec Python</li>
<li>Intérêt : FastAPI est facile à utiliser et à apprendre, réduit la duplication de code, et produit du code prêt pour la production avec une documentation interactive basée sur les standards OpenAPI et JSON Schema.</li>
<li>Gouvernance : Assurée par une équipe de mainteneurs dont <span style="display:inline-flex;gap:0.25rem"><span></span><a href="https://github.com/tiangolo" target="_blank" rel="noopener noreferrer">tiangolo</a></span> est le créateur et mainteneurs principal. A cela s'ajoute des contributeurs individuels, le projet est soutenu par la communauté.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fastapi-vs-flask">FastAPI vs Flask<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/12/15/09-scripting/fastapi#fastapi-vs-flask" class="hash-link" aria-label="Direct link to FastAPI vs Flask" title="Direct link to FastAPI vs Flask">​</a></h3>
<p><strong>FastAPI</strong> est reconnu pour sa rapidité et ses performances élevées, grâce à Starlette et Pydantic. Il utilise les annotations de types standard de Python, ce qui améliore la validation et la sérialisation des données. FastAPI génère automatiquement une documentation interactive et est basé sur les standards OpenAPI et JSON Schema. Il est idéal pour les projets nécessitant des performances élevées et une validation stricte des données.</p>
<p><strong>Flask</strong>, en revanche, est un micro-framework léger et flexible, facile à apprendre et à utiliser. Il offre une grande liberté aux développeurs pour structurer leurs applications comme ils le souhaitent. Flask est extensible via de nombreuses extensions tierces, ce qui le rend adapté aux projets de toutes tailles. Cependant, il ne fournit pas de validation de données intégrée ni de documentation automatique comme FastAPI.</p>
<p>En résumé, FastAPI est plus adapté pour les projets nécessitant des performances élevées et une validation stricte des données, tandis que Flask est conçu pour les projets nécessitant flexibilité et simplicité.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation">Utilisation<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/12/15/09-scripting/fastapi#utilisation" class="hash-link" aria-label="Direct link to Utilisation" title="Direct link to Utilisation">​</a></h2>
<p>Pour installer FastAPI, vous pouvez utiliser pip :</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">pip </span><span class="token function" style="color:hsl(207, 82%, 66%)">install</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"fastapi[standard]"</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>L'exemple ci dessous est une API simpliste de gestion des To-Do List permettant aux utilisateurs de créér, lire, mettre à jour et supprimer des tâches. Les spécifications sont les suivantes :</p>
<ol>
<li>Créer une tâche : Permettre aux utilisateurs de créer une nouvelle tâche avec un titre et une description.</li>
<li>Lire les tâches : Récupérer la liste de toutes les tâches ou une tâche spécifique par son identifiant.</li>
<li>Mettre à jour une tâche : Modifier les détails d'une tâche existante.</li>
<li>Supprimer une tâche : Supprimer une tâche par son identifiant.</li>
</ol>
<p>L'exemple ci dessous mélange plusieurs fonctionnalités de FastAPI.</p>
<div class="language-python codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-python codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token keyword" style="color:hsl(286, 60%, 67%)">from</span><span class="token plain"> datetime </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">import</span><span class="token plain"> date</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">from</span><span class="token plain"> typing </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">import</span><span class="token plain"> Optional</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">from</span><span class="token plain"> fastapi </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">import</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> Query</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">from</span><span class="token plain"> pydantic </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">import</span><span class="token plain"> BaseModel</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">import</span><span class="token plain"> uvicorn</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">app </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> FastAPI</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">class</span><span class="token plain"> </span><span class="token class-name" style="color:hsl(29, 54%, 61%)">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">BaseModel</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    title</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">str</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    date</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> date</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">list</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">@app</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">post</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">"/tasks/"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">create_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> task</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">@app</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">get</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">"/tasks/"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token builtin" style="color:hsl(95, 38%, 62%)">list</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">read_tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">skip</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">int</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> limit</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">int</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">10</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">skip </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> skip </span><span class="token operator" style="color:hsl(207, 82%, 66%)">+</span><span class="token plain"> limit</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">@app</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">get</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">"/tasks/{task_id}"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">read_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">task_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">int</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">in</span><span class="token plain"> tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token builtin" style="color:hsl(95, 38%, 62%)">id</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> task_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> task</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string" style="color:hsl(95, 38%, 62%)">"error"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Task not found"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">@app</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">put</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">"/tasks/{task_id}"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">update_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">task_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">int</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> updated_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">in</span><span class="token plain"> tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token builtin" style="color:hsl(95, 38%, 62%)">id</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> task_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">title </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> updated_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">title</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">description </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> updated_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">description</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">date </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> updated_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">date</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> task</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string" style="color:hsl(95, 38%, 62%)">"error"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Task not found"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">@app</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">delete</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">"/tasks/{task_id}"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">delete_task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain">task_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token builtin" style="color:hsl(95, 38%, 62%)">int</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">global</span><span class="token plain"> tasks</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    tasks </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">in</span><span class="token plain"> tasks </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token builtin" style="color:hsl(95, 38%, 62%)">id</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">!=</span><span class="token plain"> task_id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token string" style="color:hsl(95, 38%, 62%)">"message"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Task deleted"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">@app</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token decorator annotation punctuation" style="color:hsl(220, 14%, 71%)">get</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token string" style="color:hsl(95, 38%, 62%)">"/search_tasks"</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> response_model</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token builtin" style="color:hsl(95, 38%, 62%)">list</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">Task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token keyword" style="color:hsl(286, 60%, 67%)">def</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">search_tasks</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    title</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token builtin" style="color:hsl(95, 38%, 62%)">str</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> Query</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token boolean" style="color:hsl(29, 54%, 61%)">None</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> date</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">date</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> Query</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token boolean" style="color:hsl(29, 54%, 61%)">None</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    results </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> tasks</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> title</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        results </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">in</span><span class="token plain"> results </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> title</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">in</span><span class="token plain"> task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">title</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">(</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">)</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> date</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        results </span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">for</span><span class="token plain"> task </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">in</span><span class="token plain"> results </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">if</span><span class="token plain"> task</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">.</span><span class="token plain">date </span><span class="token operator" style="color:hsl(207, 82%, 66%)">==</span><span class="token plain"> date</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token keyword" style="color:hsl(286, 60%, 67%)">return</span><span class="token plain"> results</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour lancer l'application :</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">fastapi run /path/to/file.py </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># production mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">fastapi dev /path/to/file.py </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># development mode</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>En plus de l'API, FastAPI génère automatiquement une documentation interactive accessible à l'adresse <code>http://127.0.0.1:8000/docs</code></p>
<p><img decoding="async" loading="lazy" alt="documentation" src="https://delpeuch.net/pr-preview/pr-15/assets/images/fast-api-documentation-f41f2ce0ce73b19223cee5acb932ddb8.png" width="1186" height="879" class="img_ev3q"></p>]]></content:encoded>
            <category>Devops</category>
            <category>Python</category>
        </item>
        <item>
            <title><![CDATA[Dokku]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku</guid>
            <pubDate>Sat, 30 Nov 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Dokku est une plateforme open-source permettant le déploiement, la gestion et la mise à l'échelle des applications sur un serveur.]]></description>
            <content:encoded><![CDATA[<p>Une alternative PAAS open source à Heroku <a href="https://dokku.com/" target="_blank" rel="noopener noreferrer">https://dokku.com/</a>
Dokku est une plateforme open-source permettant le déploiement, la gestion et la mise à l'échelle des applications sur un serveur. Inspiré par Heroku, il utilise une approche similaire pour le déploiement d'applications : le code se déploie en effectuant un "push" vers un dépôt Git sur le serveur. À la différence de Heroku, Dokku offre un contrôle total sur l'environnement de déploiement. Ainsi, l'infrastructure, le système d'exploitation et les services (tels que les bases de données ou les files d'attente de tâches) peuvent être personnalisés selon les besoins. Dokku s'appuie sur Docker pour gérer les applications dans des conteneurs isolés, ce qui simplifie la gestion des applications et de leurs dépendances. Chaque "push" d'une application à Dokku crée un nouveau conteneur Docker.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># download the installation script</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">wget</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-NP</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">.</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">https://dokku.com/bootstrap.sh</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># run the installer</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">DOKKU_TAG</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">v0.32.3 </span><span class="token function" style="color:hsl(207, 82%, 66%)">bash</span><span class="token plain"> bootstrap.sh</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># and your ssh key to the dokku user</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">PUBLIC_KEY</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token string" style="color:hsl(95, 38%, 62%)">"your-public-key-contents-here"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">echo</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token string variable" style="color:hsl(207, 82%, 66%)">$PUBLIC_KEY</span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">|</span><span class="token plain"> dokku ssh-keys:add admin</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="première-application">Première application<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku#premi%C3%A8re-application" class="hash-link" aria-label="Direct link to Première application" title="Direct link to Première application">​</a></h2>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># define global domains</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">dokku domains:set-global </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">your-domain</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># &lt;your-domain&gt; can be a rd party domain or a local domain like sonu-dev-gzsim.local</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Sur la machine où <code>dokku</code> est installé</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">dokku apps:create </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">app-name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> dokku plugin:install </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">https://github.com/dokku/dokku-postgres.git</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">dokku postgres:create railsdatabase</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">dokku postgres:link railsdatabase </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">app-name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Sur la machine locale</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">cd</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">app-name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> remote </span><span class="token function" style="color:hsl(207, 82%, 66%)">add</span><span class="token plain"> dokku dokku@</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">your-domain</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">app-name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> push dokku main</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="construire-sa-propre-application">Construire sa propre application<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku#construire-sa-propre-application" class="hash-link" aria-label="Direct link to Construire sa propre application" title="Direct link to Construire sa propre application">​</a></h2>
<p>Dokku supporte plusieurs méthodes de build pour créer des applications, chacun avec ses propres avantages spécifiques :</p>
<ol>
<li><a href="https://dokku.com/docs/deployment/builders/dockerfiles/" target="_blank" rel="noopener noreferrer"><strong>builder-dockerfile</strong></a>: Cette méthode utilise un Dockerfile pour construire des applications via la commande <code>docker build</code>. Il donne un contrôle maximal sur l'environnement d'exécution de l'application et sur la manière dont l'application est assemblée.</li>
<li><a href="https://dokku.com/docs/deployment/builders/herokuish-buildpacks/" target="_blank" rel="noopener noreferrer"><strong>builder-herokuish</strong></a>: Avec cette méthode, Dokku crée des applications en utilisant la spécification v2a Buildpack de Heroku via <code>gliderlabs/herokuish</code>. Il vous permet de profiter du même pipeline de build que Heroku, qui inclut le support pour de nombreux langages de programmation par défaut.</li>
<li>builder-lambda: Ce générateur construit des fonctions AWS Lambda dans un environnement simulant les temps d'exécution d'AWS Lambda.</li>
<li><strong>builder-null</strong>: Cette méthode ne fait rien pendant la phase de construction. C'est utile pour les scénarios où aucune construction n'est nécessaire, comme le déploiement d'applications déjà compilées ou de conteneurs Docker.</li>
<li><strong>builder-pack</strong>: Cette méthode utilise les Cloud Native Buildpacks pour construire des applications via l'outil pack-cli. Les Cloud Native Buildpacks sont une norme ouverte qui étend les capacités des Buildpacks classiques.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="automatiser-le-déploiement-via-github-actions">Automatiser le déploiement via Github Actions<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku#automatiser-le-d%C3%A9ploiement-via-github-actions" class="hash-link" aria-label="Direct link to Automatiser le déploiement via Github Actions" title="Direct link to Automatiser le déploiement via Github Actions">​</a></h2>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Deploy to Dokku (sonu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">dev</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">gzsim)</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">schedule</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">cron</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'0 0 * * *'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">workflow_dispatch</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">workflow_run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">workflows</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Test build"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">types</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> completed</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">deploy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">group</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Cloning repo</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">fetch-depth</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Tailscale</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> tailscale/github</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@v2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">oauth-client-id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.TS_OAUTH_CLIENT_ID </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">oauth-secret</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.TS_OAUTH_SECRET </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">tags</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> tag</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">server</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Push to dokku</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> dokku/github</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@master</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">git_remote_url</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'ssh://dokku@100.65.237.90:22/rd25-robotics'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ssh_private_key</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.SSH_PRIVATE_KEY </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">branch</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">git_push_flags</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'--force'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">if</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> github.event.workflow_run.conclusion == 'success' </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="astuces">Astuces<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/30/06-orchestration/orchestration-dokku#astuces" class="hash-link" aria-label="Direct link to Astuces" title="Direct link to Astuces">​</a></h2>
<p>⚠️ Les astuces ci dessous correspondent <strong>très certainement</strong> à une incompréhension des mécanismes de domain, proxy et reverse proxy</p>
<p>Par défaut <code>dokku</code> déploie l’application sur une url construite comme suit : <code>http://&lt;app-name&gt;.&lt;your-domain&gt;</code> visiblement si le domaine est local (comme <code>sonu-dev-gzsim.local</code>) le reverse proxy ne fonctionne pas (la configuration <code>nginx</code> est à creuser) il est donc nécessaire de <code>disable</code> les domains avec la commande</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">dokku domains:disable </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">app-name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Cela aura pour effet de désactiver le domaine pour l’application en question. Elle tournera donc directement sur le port défini aléatoirement par <code>dokku</code>.
À chaque déploiement, <code>dokku</code> construit un <code>dokker</code> pour gérer les applications de manière isolée. Par défaut, les applications de type web doivent fournir leurs services sur le port <code>5000</code>. Par la suite, <code>dokku</code> s’occupe de faire la redirection de port entre la machine et le container. Pour éviter d’avoir un port aléatoire, il est possible de faire</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">dokku ports:set </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">app-name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> http:</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">machine-port</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">docker-port</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ainsi, à chaque déploiement, <code>dokku</code> redirigera le port de la machine vers le port du docker.
Finalement si vous souhaitez mettre en place une redirection comme <code>http://&lt;your-domain&gt;/&lt;app-name&gt;</code> vers l’application il suffit de faire les modifications suivantes dans <code>nginx</code>
Modifiez le fichier de configuration de Nginx pour votre site :</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">nano</span><span class="token plain"> /etc/nginx/sites-available/your-config-file</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ajoutez la directive location dans votre configuration :</p>
<div class="language-txt codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-txt codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">server { listen 80; server_name &lt;your-domain&gt;; location = &lt;app-name&gt; { return 301 http://$host:&lt;machine-port&gt;; } }</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Créez un lien symbolique vers le fichier de configuration :</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">ln</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-s</span><span class="token plain"> /etc/nginx/sites-available/your-config-file /etc/nginx/sites-enabled/</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Vérifiez la configuration de Nginx :</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> nginx </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-t</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Redémarrez Nginx pour appliquer les modifications :</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> systemctl restart nginx</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>Devops</category>
            <category>Orchestration</category>
            <category>Alternatives</category>
        </item>
        <item>
            <title><![CDATA[Docker Compose]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose</guid>
            <pubDate>Fri, 01 Nov 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Explication de Docker Compose]]></description>
            <content:encoded><![CDATA[<p>Docker Compose est un outil puissant qui permet de définir et de gérer des applications multi-conteneurs Docker. Il utilise un fichier YAML pour configurer les services de l'application. Ensuite, avec une seule commande, vous pouvez créer et démarrer tous les services à partir de votre configuration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-que-docker-compose-">Qu'est-ce que Docker Compose ?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#quest-ce-que-docker-compose-" class="hash-link" aria-label="Direct link to Qu'est-ce que Docker Compose ?" title="Direct link to Qu'est-ce que Docker Compose ?">​</a></h2>
<p>Docker Compose est un outil qui permet de définir et de gérer des applications multi-conteneurs Docker. Il utilise un fichier YAML pour configurer les services de l'application. Ensuite, avec une seule commande, vous pouvez créer et démarrer tous les services à partir de votre configuration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-fichier-docker-compose">Exemple de fichier Docker Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#exemple-de-fichier-docker-compose" class="hash-link" aria-label="Direct link to Exemple de fichier Docker Compose" title="Direct link to Exemple de fichier Docker Compose">​</a></h2>
<p>Voici un exemple de fichier <code>docker-compose.yml</code> pour une application web simple avec un service web et une base de données :</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">version</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'3'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">services</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">web</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ports</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"80:80"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">db</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> postgres</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">environment</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">POSTGRES_DB</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> exampledb</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">POSTGRES_USER</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> exampleuser</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">POSTGRES_PASSWORD</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> examplepass</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Dans cet exemple, nous avons deux services : <code>web</code> et <code>db</code>. Le service <code>web</code> utilise l'image <code>nginx:alpine</code> et mappe le port 80 du conteneur au port 80 de l'hôte. Le service <code>db</code> utilise l'image <code>postgres:alpine</code> et définit quelques variables d'environnement pour configurer la base de données.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="commandes-docker-compose">Commandes Docker Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#commandes-docker-compose" class="hash-link" aria-label="Direct link to Commandes Docker Compose" title="Direct link to Commandes Docker Compose">​</a></h2>
<p>Voici quelques commandes Docker Compose couramment utilisées :</p>
<ul>
<li><code>docker-compose up</code> : Crée et démarre les conteneurs définis dans le fichier <code>docker-compose.yml</code>.</li>
<li><code>docker-compose down</code> : Arrête et supprime les conteneurs, les réseaux et les volumes créés par <code>docker-compose up</code>.</li>
<li><code>docker-compose ps</code> : Affiche l'état des conteneurs définis dans le fichier <code>docker-compose.yml</code>.</li>
<li><code>docker-compose logs</code> : Affiche les logs des conteneurs.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schéma-explicatif">Schéma explicatif<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#sch%C3%A9ma-explicatif" class="hash-link" aria-label="Direct link to Schéma explicatif" title="Direct link to Schéma explicatif">​</a></h2>
<p>Voici un schéma expliquant comment Docker Compose fonctionne :</p>
<p><img decoding="async" loading="lazy" src="https://www.biaudelle.fr/wp-content/uploads/2021/07/docker-compose-archi.png" alt="Schéma Docker Compose" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="démonstration-pratique">Démonstration pratique<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#d%C3%A9monstration-pratique" class="hash-link" aria-label="Direct link to Démonstration pratique" title="Direct link to Démonstration pratique">​</a></h2>
<p>Pour mieux comprendre l'utilisation de Docker Compose, voici une démonstration pratique :</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> network create mynetwork</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker-compose</span><span class="token plain"> up </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-d</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker-compose</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">ps</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ouvrez votre navigateur et accédez à <code>http://localhost</code>.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker-compose</span><span class="token plain"> down</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="avantages-clés-de-docker-compose">Avantages clés de Docker Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#avantages-cl%C3%A9s-de-docker-compose" class="hash-link" aria-label="Direct link to Avantages clés de Docker Compose" title="Direct link to Avantages clés de Docker Compose">​</a></h2>
<p>L'utilisation de Docker Compose offre plusieurs avantages qui simplifient le développement, le déploiement et la gestion des applications conteneurisées :</p>
<ul>
<li><strong>Contrôle simplifié</strong> : Docker Compose vous permet de définir et de gérer des applications multi-conteneurs dans un seul fichier YAML. Cela simplifie la tâche complexe d'orchestrer et de coordonner divers services, rendant plus facile la gestion et la réplication de votre environnement applicatif.</li>
<li><strong>Collaboration efficace</strong> : Les fichiers de configuration Docker Compose sont faciles à partager, facilitant la collaboration entre les développeurs, les équipes d'exploitation et les autres parties prenantes. Cette approche collaborative conduit à des flux de travail plus fluides, une résolution des problèmes plus rapide et une efficacité globale accrue.</li>
<li><strong>Développement rapide d'applications</strong> : Compose met en cache la configuration utilisée pour créer un conteneur. Lorsque vous redémarrez un service qui n'a pas changé, Compose réutilise les conteneurs existants. La réutilisation des conteneurs signifie que vous pouvez apporter des modifications à votre environnement très rapidement.</li>
<li><strong>Portabilité entre les environnements</strong> : Compose prend en charge les variables dans le fichier Compose. Vous pouvez utiliser ces variables pour personnaliser votre composition pour différents environnements ou différents utilisateurs.</li>
<li><strong>Communauté et support étendus</strong> : Docker Compose bénéficie d'une communauté dynamique et active, ce qui signifie des ressources abondantes, des tutoriels et un support. Cet écosystème communautaire contribue à l'amélioration continue de Docker Compose et aide les utilisateurs à résoudre efficacement les problèmes.</li>
</ul>
<p>Compose peut être utilisé de nombreuses manières différentes. Voici quelques cas d'utilisation courants.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environnements-de-développement">Environnements de développement<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#environnements-de-d%C3%A9veloppement" class="hash-link" aria-label="Direct link to Environnements de développement" title="Direct link to Environnements de développement">​</a></h3>
<p>Lorsque vous développez des logiciels, la capacité à exécuter une application dans un environnement isolé et à interagir avec elle est cruciale. L'outil en ligne de commande Compose peut être utilisé pour créer l'environnement et interagir avec lui.</p>
<p>Le fichier Compose fournit un moyen de documenter et de configurer toutes les dépendances de service de l'application (bases de données, files d'attente, caches, API de services web, etc.). En utilisant l'outil en ligne de commande Compose, vous pouvez créer et démarrer un ou plusieurs conteneurs pour chaque dépendance avec une seule commande (<code>docker compose up</code>).</p>
<p>Ensemble, ces fonctionnalités offrent un moyen pratique de démarrer un projet. Compose peut réduire un "guide de démarrage pour les développeurs" de plusieurs pages à un seul fichier Compose lisible par machine et quelques commandes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environnements-de-test-automatisés">Environnements de test automatisés<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#environnements-de-test-automatis%C3%A9s" class="hash-link" aria-label="Direct link to Environnements de test automatisés" title="Direct link to Environnements de test automatisés">​</a></h3>
<p>Une partie importante de tout processus de déploiement continu ou d'intégration continue est la suite de tests automatisés. Les tests automatisés de bout en bout nécessitent un environnement dans lequel exécuter les tests. Compose fournit un moyen pratique de créer et de détruire des environnements de test isolés pour votre suite de tests. En définissant l'environnement complet dans un fichier Compose, vous pouvez créer et détruire ces environnements en quelques commandes seulement.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="déploiements-sur-un-seul-hôte">Déploiements sur un seul hôte<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#d%C3%A9ploiements-sur-un-seul-h%C3%B4te" class="hash-link" aria-label="Direct link to Déploiements sur un seul hôte" title="Direct link to Déploiements sur un seul hôte">​</a></h3>
<p>Compose a traditionnellement été axé sur les flux de travail de développement et de test, mais à chaque nouvelle version, nous progressons sur des fonctionnalités plus orientées vers la production.</p>
<p>Pour plus de détails sur l'utilisation des fonctionnalités orientées production, consultez <a href="https://docs.docker.com/compose/production/" target="_blank" rel="noopener noreferrer">Compose en production</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-des-secrets-avec-docker-compose">Utilisation des secrets avec Docker Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#utilisation-des-secrets-avec-docker-compose" class="hash-link" aria-label="Direct link to Utilisation des secrets avec Docker Compose" title="Direct link to Utilisation des secrets avec Docker Compose">​</a></h2>
<p>Docker Compose permet également de gérer les secrets de manière sécurisée. Les secrets sont des informations sensibles telles que des mots de passe, des clés API, etc., qui ne doivent pas être exposées dans le code source.</p>
<p>Voici un exemple de configuration de secrets dans un fichier <code>docker-compose.yml</code> :</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">version</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'3.7'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">services</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">web</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">secrets</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> my_secret</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">secrets</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">my_secret</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">file</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ./my_secret.txt</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Dans cet exemple, le service <code>web</code> utilise un secret nommé <code>my_secret</code> qui est défini dans le fichier <code>my_secret.txt</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="support-des-gpu-avec-docker-compose">Support des GPU avec Docker Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#support-des-gpu-avec-docker-compose" class="hash-link" aria-label="Direct link to Support des GPU avec Docker Compose" title="Direct link to Support des GPU avec Docker Compose">​</a></h2>
<p>Docker Compose prend également en charge l'utilisation des GPU pour les applications nécessitant des capacités de calcul intensif, telles que l'apprentissage automatique et le traitement d'images.</p>
<p>Voici un exemple de configuration pour utiliser un GPU avec Docker Compose :</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">version</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'3.8'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">services</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">gpu_service</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nvidia/cuda</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">10.2</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">base</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">deploy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">resources</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">reservations</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">devices</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">capabilities</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">gpu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Dans cet exemple, le service <code>gpu_service</code> utilise l'image <code>nvidia/cuda:10.2-base</code> et réserve un GPU pour le conteneur.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-de-la-surveillance-des-fichiers-avec-docker-compose">Utilisation de la surveillance des fichiers avec Docker Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#utilisation-de-la-surveillance-des-fichiers-avec-docker-compose" class="hash-link" aria-label="Direct link to Utilisation de la surveillance des fichiers avec Docker Compose" title="Direct link to Utilisation de la surveillance des fichiers avec Docker Compose">​</a></h2>
<p>Docker Compose permet également de surveiller les modifications des fichiers et de redémarrer automatiquement les services concernés. Cela est particulièrement utile pour les environnements de développement.</p>
<p>Voici un exemple de configuration de surveillance des fichiers dans un fichier <code>docker-compose.yml</code> :</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">version</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'3.8'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">services</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">web</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">volumes</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> ./src</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">/usr/share/nginx/html</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">command</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> sh </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">c "nginx </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">g 'daemon off;'"</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">file_watch</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">watch</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ./src</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> restart</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Dans cet exemple, le service <code>web</code> surveille les modifications dans le répertoire <code>./src</code> et redémarre automatiquement le service lorsque des modifications sont détectées.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="réseau-dans-compose">Réseau dans Compose<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#r%C3%A9seau-dans-compose" class="hash-link" aria-label="Direct link to Réseau dans Compose" title="Direct link to Réseau dans Compose">​</a></h2>
<blockquote>
<p><strong>Important</strong></p>
<p>La documentation de Docker se réfère et décrit les fonctionnalités de Compose V2.</p>
<p>À partir de juillet 2023, Compose V1 a cessé de recevoir des mises à jour et n'est plus inclus dans les nouvelles versions de Docker Desktop. Compose V2 l'a remplacé et est maintenant intégré dans toutes les versions actuelles de Docker Desktop. Pour plus d'informations, consultez <a href="https://docs.docker.com/compose/migrate" target="_blank" rel="noopener noreferrer">Migrer vers Compose V2</a>.</p>
</blockquote>
<p>Par défaut, Compose configure un seul <a href="https://docs.docker.com/reference/cli/docker/network/create/" target="_blank" rel="noopener noreferrer">réseau</a> pour votre application. Chaque conteneur pour un service rejoint le réseau par défaut et est à la fois accessible par d'autres conteneurs sur ce réseau et découvrable par le nom du service.</p>
<blockquote>
<p><strong>Remarque</strong></p>
<p>Le réseau de votre application reçoit un nom basé sur le "nom du projet", qui est basé sur le nom du répertoire dans lequel il se trouve. Vous pouvez remplacer le nom du projet avec soit le <a href="https://docs.docker.com/reference/" target="_blank" rel="noopener noreferrer">flag <code>--project-name</code></a> soit la <a href="https://docs.docker.com/compose/environment-variables/envvars/#compose_project_name" target="_blank" rel="noopener noreferrer">variable d'environnement <code>COMPOSE_PROJECT_NAME</code></a>.</p>
</blockquote>
<p>Par exemple, supposons que votre application se trouve dans un répertoire appelé <code>myapp</code>, et que votre <code>compose.yml</code> ressemble à ceci :</p>
<p>Lorsque vous exécutez <code>docker compose up</code>, les actions suivantes se produisent :</p>
<ol>
<li>Un réseau appelé <code>myapp_default</code> est créé.</li>
<li>Un conteneur est créé en utilisant la configuration de <code>web</code>. Il rejoint le réseau <code>myapp_default</code> sous le nom <code>web</code>.</li>
<li>Un conteneur est créé en utilisant la configuration de <code>db</code>. Il rejoint le réseau <code>myapp_default</code> sous le nom <code>db</code>.</li>
</ol>
<p>Chaque conteneur peut maintenant rechercher le nom du service <code>web</code> ou <code>db</code> et obtenir l'adresse IP appropriée du conteneur. Par exemple, le code de l'application de <code>web</code> pourrait se connecter à l'URL <code>postgres://db:5432</code> et commencer à utiliser la base de données Postgres.</p>
<p>Il est important de noter la distinction entre <code>HOST_PORT</code> et <code>CONTAINER_PORT</code>. Dans l'exemple ci-dessus, pour <code>db</code>, le <code>HOST_PORT</code> est <code>8001</code> et le port du conteneur est <code>5432</code> (par défaut pour postgres). La communication de service à service en réseau utilise le <code>CONTAINER_PORT</code>. Lorsque <code>HOST_PORT</code> est défini, le service est également accessible en dehors du swarm.</p>
<p>Dans le conteneur <code>web</code>, votre chaîne de connexion à <code>db</code> ressemblerait à <code>postgres://db:5432</code>, et depuis la machine hôte, la chaîne de connexion ressemblerait à <code>postgres://{DOCKER_IP}:8001</code>, par exemple <code>postgres://localhost:8001</code> si votre conteneur s'exécute localement.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mise-à-jour-des-conteneurs-sur-le-réseau">Mise à jour des conteneurs sur le réseau<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#mise-%C3%A0-jour-des-conteneurs-sur-le-r%C3%A9seau" class="hash-link" aria-label="Direct link to Mise à jour des conteneurs sur le réseau" title="Direct link to Mise à jour des conteneurs sur le réseau">​</a></h3>
<p>Si vous apportez une modification de configuration à un service et exécutez <code>docker compose up</code> pour le mettre à jour, l'ancien conteneur est supprimé et le nouveau rejoint le réseau sous une adresse IP différente mais avec le même nom. Les conteneurs en cours d'exécution peuvent rechercher ce nom et se connecter à la nouvelle adresse, mais l'ancienne adresse cesse de fonctionner.</p>
<p>Si des conteneurs ont des connexions ouvertes vers l'ancien conteneur, elles sont fermées. Il incombe au conteneur de détecter cette condition, de rechercher à nouveau le nom et de se reconnecter.</p>
<blockquote>
<p><strong>Astuce</strong></p>
<p>Référencez les conteneurs par nom, et non par IP, chaque fois que possible. Sinon, vous devrez constamment mettre à jour l'adresse IP que vous utilisez.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="réseau-multi-hôte">Réseau multi-hôte<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#r%C3%A9seau-multi-h%C3%B4te" class="hash-link" aria-label="Direct link to Réseau multi-hôte" title="Direct link to Réseau multi-hôte">​</a></h3>
<p>Lors du déploiement d'une application Compose sur un moteur Docker avec <a href="https://docs.docker.com/engine/swarm/" target="_blank" rel="noopener noreferrer">le mode Swarm activé</a>, vous pouvez utiliser le pilote intégré <code>overlay</code> pour activer la communication multi-hôte.</p>
<p>Les réseaux overlay sont toujours créés comme <code>attachable</code>. Vous pouvez éventuellement définir la propriété <a href="https://docs.docker.com/reference/compose-file/networks/#attachable" target="_blank" rel="noopener noreferrer"><code>attachable</code></a> sur <code>false</code>.</p>
<p>Consultez la <a href="https://docs.docker.com/engine/swarm/" target="_blank" rel="noopener noreferrer">section mode Swarm</a> pour savoir comment configurer un cluster Swarm, et le <a href="https://docs.docker.com/engine/network/tutorials/overlay/" target="_blank" rel="noopener noreferrer">guide de démarrage avec le réseau multi-hôte</a> pour en savoir plus sur les réseaux overlay multi-hôte.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spécifier-des-réseaux-personnalisés">Spécifier des réseaux personnalisés<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#sp%C3%A9cifier-des-r%C3%A9seaux-personnalis%C3%A9s" class="hash-link" aria-label="Direct link to Spécifier des réseaux personnalisés" title="Direct link to Spécifier des réseaux personnalisés">​</a></h3>
<p>Au lieu d'utiliser simplement le réseau d'application par défaut, vous pouvez spécifier vos propres réseaux avec la clé de niveau supérieur <code>networks</code>. Cela vous permet de créer des topologies plus complexes et de spécifier des <a href="https://docs.docker.com/engine/extend/plugins_network/" target="_blank" rel="noopener noreferrer">pilotes de réseau personnalisés</a> et des options. Vous pouvez également l'utiliser pour connecter des services à des réseaux créés en externe qui ne sont pas gérés par Compose.</p>
<p>Chaque service peut spécifier à quels réseaux se connecter avec la clé de niveau service <code>networks</code>, qui est une liste de noms référencant des entrées sous la clé de niveau supérieur <code>networks</code>.</p>
<p>L'exemple suivant montre un fichier Compose qui définit deux réseaux personnalisés. Le service <code>proxy</code> est isolé du service <code>db</code>, car ils ne partagent pas de réseau en commun. Seul <code>app</code> peut parler aux deux.</p>
<p>Les réseaux peuvent être configurés avec des adresses IP statiques en définissant l'<a href="https://docs.docker.com/reference/compose-file/services/#ipv4_address-ipv6_address" target="_blank" rel="noopener noreferrer">adresse ipv4 et/ou ipv6</a> pour chaque réseau attaché.</p>
<p>Les réseaux peuvent également recevoir un <a href="https://docs.docker.com/reference/compose-file/networks/#name" target="_blank" rel="noopener noreferrer">nom personnalisé</a> :</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configurer-le-réseau-par-défaut">Configurer le réseau par défaut<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#configurer-le-r%C3%A9seau-par-d%C3%A9faut" class="hash-link" aria-label="Direct link to Configurer le réseau par défaut" title="Direct link to Configurer le réseau par défaut">​</a></h3>
<p>Au lieu de, ou en plus de, spécifier vos propres réseaux, vous pouvez également modifier les paramètres du réseau par défaut de l'application en définissant une entrée sous <code>networks</code> nommée <code>default</code> :</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="utiliser-un-réseau-préexistant">Utiliser un réseau préexistant<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#utiliser-un-r%C3%A9seau-pr%C3%A9existant" class="hash-link" aria-label="Direct link to Utiliser un réseau préexistant" title="Direct link to Utiliser un réseau préexistant">​</a></h3>
<p>Si vous souhaitez que vos conteneurs rejoignent un réseau préexistant, utilisez l'option <a href="https://docs.docker.com/reference/compose-file/networks/#external" target="_blank" rel="noopener noreferrer"><code>external</code></a></p>
<p>Au lieu de tenter de créer un réseau appelé <code>[projectname]_default</code>, Compose recherche un réseau appelé <code>my-pre-existing-network</code> et connecte les conteneurs de votre application à celui-ci.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/11/01/06-orchestration/docker-compose#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Docker Compose est un outil puissant pour gérer des applications multi-conteneurs. Il simplifie la configuration, l'isolation des environnements et la portabilité des applications. En utilisant Docker Compose, vous pouvez facilement définir et gérer des environnements de développement, de test et de mise en scène, ainsi que des déploiements de production simples.</p>
<p>Pour en savoir plus sur Docker Compose, vous pouvez consulter la <a href="https://docs.docker.com/compose/" target="_blank" rel="noopener noreferrer">documentation officielle</a>.</p>]]></content:encoded>
            <category>Docker Compose</category>
            <category>Devops</category>
            <category>Orchestration</category>
        </item>
        <item>
            <title><![CDATA[Containerization vs Virtualization]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/10/15/03-containerization/difference-conteneurisation-virtualisation</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/10/15/03-containerization/difference-conteneurisation-virtualisation</guid>
            <pubDate>Tue, 15 Oct 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Comparaison entre Docker et les machines virtuelles (VM) en termes de taille d'image, de vitesse et de compatibilité.]]></description>
            <content:encoded><![CDATA[<p>Docker et les machines virtuelles (VM) sont des outils de virtualisation, mais ils fonctionnent différemment. Docker virtualise la couche des applications du système d'exploitation, utilisant le noyau de l'hôte, tandis qu'une VM virtualise l'ensemble du système d'exploitation, incluant son propre noyau et sa couche d'applications. Cette différence entraîne plusieurs distinctions majeures.</p>
<p>Docker et les machines virtuelles (VM) sont des outils de virtualisation, mais ils fonctionnent différemment. Docker virtualise la couche des applications du système d'exploitation, utilisant le noyau de l'hôte, tandis qu'une VM virtualise l'ensemble du système d'exploitation, incluant son propre noyau et sa couche d'applications. Cette différence entraîne plusieurs distinctions majeures.</p>
<p>Les images Docker sont beaucoup plus petites et rapides à télécharger que les images de VM, car elles n'ont qu'une seule couche à implémenter. Les images Docker sont généralement de quelques mégaoctets, tandis que les images de VM peuvent atteindre plusieurs gigaoctets.</p>
<p>Les conteneurs Docker démarrent beaucoup plus rapidement que les VM, car ils n'ont besoin de démarrer que la couche des applications, contrairement aux VM qui doivent démarrer l'ensemble du système d'exploitation.</p>
<p>Docker présente des problèmes de compatibilité. Une image de VM de n'importe quel système d'exploitation peut être exécutée sur n'importe quel hôte, mais ce n'est pas le cas pour Docker. Par exemple, une image Docker basée sur Linux ne peut pas utiliser le noyau Windows directement. Cependant, Docker Desktop permet de contourner ce problème en utilisant une couche hyperviseur avec une distribution Linux légère pour fournir le noyau nécessaire.</p>
<p>En résumé, Docker est plus léger et rapide, mais moins compatible que les VM. Docker Desktop permet de développer localement sur Windows ou Mac en exécutant des conteneurs basés sur Linux.</p>]]></content:encoded>
            <category>Containerization</category>
            <category>Virtualization</category>
            <category>Docker</category>
            <category>VM</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[GitHub GHCR]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc</guid>
            <pubDate>Tue, 01 Oct 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[GitHub Container Registry (GHCR) est un service d'hébergement de packages logiciels proposé par GitHub, permettant aux utilisateurs de stocker des packages privés ou publics et de les utiliser comme dépendances dans leurs projets. Compatible avec plusieurs langages de programmation, GitHub Packages propose des registres pour des gestionnaires de packages tels que npm, RubyGems, Maven, Gradle, Docker, et NuGet. L'authentification sur GitHub Packages se fait exclusivement via un "personal access token (classic)". Les utilisateurs doivent disposer de ce token pour effectuer des opérations telles que la publication, l'installation et la suppression de packages, qu'ils soient publics, privés ou internes. Pour les packages privés, GitHub Packages applique des limites de stockage et de transfert de données en fonction du plan du compte. La gestion des packages peut être réalisée à travers l'interface utilisateur GitHub ou via l'API REST. Des webhooks peuvent également être configurés pour suivre des événements liés aux packages, comme la publication ou la mise à jour.]]></description>
            <content:encoded><![CDATA[<p>GitHub Container Registry (GHCR) est un service d'hébergement de packages logiciels proposé par GitHub, permettant aux utilisateurs de stocker des packages privés ou publics et de les utiliser comme dépendances dans leurs projets. Compatible avec plusieurs langages de programmation, GitHub Packages propose des registres pour des gestionnaires de packages tels que npm, RubyGems, Maven, Gradle, Docker, et NuGet. L'authentification sur GitHub Packages se fait exclusivement via un "personal access token (classic)". Les utilisateurs doivent disposer de ce token pour effectuer des opérations telles que la publication, l'installation et la suppression de packages, qu'ils soient publics, privés ou internes. Pour les packages privés, GitHub Packages applique des limites de stockage et de transfert de données en fonction du plan du compte. La gestion des packages peut être réalisée à travers l'interface utilisateur GitHub ou via l'API REST. Des webhooks peuvent également être configurés pour suivre des événements liés aux packages, comme la publication ou la mise à jour.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-que-github-ghcr">Qu'est-ce que GitHub GHCR?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc#quest-ce-que-github-ghcr" class="hash-link" aria-label="Direct link to Qu'est-ce que GitHub GHCR?" title="Direct link to Qu'est-ce que GitHub GHCR?">​</a></h2>
<p>GitHub Container Registry (GHCR) est un service d'hébergement de conteneurs Docker proposé par GitHub. Il permet aux utilisateurs de stocker, gérer et distribuer des images Docker en toute sécurité. GHCR est intégré à GitHub, ce qui facilite l'utilisation des conteneurs dans les workflows de développement et de déploiement.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pourquoi-utiliser-github-ghcr">Pourquoi utiliser GitHub GHCR?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc#pourquoi-utiliser-github-ghcr" class="hash-link" aria-label="Direct link to Pourquoi utiliser GitHub GHCR?" title="Direct link to Pourquoi utiliser GitHub GHCR?">​</a></h2>
<p>L'utilisation de GitHub GHCR présente plusieurs avantages :</p>
<ol>
<li>
<p><strong>Sécurité</strong> : GHCR offre des fonctionnalités de sécurité avancées, telles que l'authentification et l'autorisation basées sur les tokens d'accès personnels (PAT). Les images peuvent être privées ou publiques, et les utilisateurs peuvent contrôler l'accès aux images en fonction de leurs besoins.</p>
</li>
<li>
<p><strong>Intégration avec GitHub</strong> : GHCR est étroitement intégré à GitHub, ce qui permet aux utilisateurs de gérer leurs images Docker directement depuis leurs dépôts GitHub. Les workflows GitHub Actions peuvent être utilisés pour automatiser la création, le test et le déploiement des images Docker.</p>
</li>
<li>
<p><strong>Gestion des versions</strong> : GHCR prend en charge la gestion des versions des images Docker, ce qui permet aux utilisateurs de suivre les modifications apportées aux images et de revenir à des versions antérieures si nécessaire.</p>
</li>
<li>
<p><strong>Suivi des événements</strong> : GHCR permet de configurer des webhooks pour suivre les événements liés aux images Docker, tels que la publication, la mise à jour et la suppression. Cela permet aux utilisateurs de rester informés des modifications apportées aux images et de réagir en conséquence.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-workflow-pour-utiliser-github-ghcr">Exemple de workflow pour utiliser GitHub GHCR<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc#exemple-de-workflow-pour-utiliser-github-ghcr" class="hash-link" aria-label="Direct link to Exemple de workflow pour utiliser GitHub GHCR" title="Direct link to Exemple de workflow pour utiliser GitHub GHCR">​</a></h2>
<p>Le workflow suppose que vous avez un <code>Dockerfile</code> à la racine du dépôt. Ce <code>Dockerfile</code> doit réussir la commande de <code>build</code> avec succès</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="créez-un-fichier-yaml-pour-le-workflow">Créez un fichier YAML pour le Workflow<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc#cr%C3%A9ez-un-fichier-yaml-pour-le-workflow" class="hash-link" aria-label="Direct link to Créez un fichier YAML pour le Workflow" title="Direct link to Créez un fichier YAML pour le Workflow">​</a></h3>
<p>Créez un fichier YAML (par exemple, <code>docker-publish.yml</code>) dans le répertoire <code>.github/workflows/</code> de votre dépôt avec le contenu suivant :</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Create and publish a Docker image</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">branches</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token string" style="color:hsl(95, 38%, 62%)">'release'</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">env</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">REGISTRY</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ghcr.io</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">IMAGE_NAME</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> github.repository </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">build-and-push-image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">permissions</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">contents</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> read</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">packages</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Checkout repository</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Log in to the Container registry</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> docker/login</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@65b78e6e13532edd9afa3aa52ac7964289d1a9c1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">registry</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> env.REGISTRY </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">username</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> github.actor </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">password</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.GITHUB_TOKEN </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Extract metadata (tags</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> labels) for Docker</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> meta</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> docker/metadata</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@9ec57ed1fcdbf14dcef7dfbe97b2010124a938b7</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">images</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> env.REGISTRY </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">/$</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> env.IMAGE_NAME </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Build and push Docker image</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> docker/build</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@f2a1d5e99d037542a71f64918e516c093c6f3fc4</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">context</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> .</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">tags</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> steps.meta.outputs.tags </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">labels</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> steps.meta.outputs.labels </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configurez-les-options-du-workflow">Configurez les Options du Workflow<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc#configurez-les-options-du-workflow" class="hash-link" aria-label="Direct link to Configurez les Options du Workflow" title="Direct link to Configurez les Options du Workflow">​</a></h3>
<p>Dans le fichier YAML, vous pouvez personnaliser les options suivantes selon vos besoins :</p>
<ul>
<li><code>branches</code>: Modifiez la branche déclenchant le workflow.</li>
<li><code>REGISTRY</code> et <code>IMAGE_NAME</code>: Modifiez-les si vous souhaitez utiliser un autre registre ou nom d'image.</li>
<li><code>permissions</code>: Ajustez les autorisations en fonction de vos besoins.</li>
</ul>
<p><strong>Enregistrez et Poussez vos Modifications</strong>
Enregistrez les modifications dans le fichier YAML et poussez-les vers la branche "release" de votre dépôt GitHub.</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">add</span><span class="token plain"> .github/workflows/docker-publish.yml</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> commit </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-m</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Ajout du workflow de publication Docker"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> push origin release</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-dun-package-ghcr">Utilisation d’un package GHCR<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/09/31/03-containerization/ghrc#utilisation-dun-package-ghcr" class="hash-link" aria-label="Direct link to Utilisation d’un package GHCR" title="Direct link to Utilisation d’un package GHCR">​</a></h3>
<p>Une fois déployé, le package s’utilise comme n’importe quel docker</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> pull ghcr.io/</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token environment constant" style="color:hsl(29, 54%, 61%)">USER</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">/</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">REPO-NAME</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">:master</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>💡 L’utilisation des Github GHCR entraine des consommations d’espace. Le CATIE a le droit à 2Gb de stockage sur GHCR et 10Gb de transit par mois. Au delà de ces limites, nous sommes facturés.
L’utilisation (sous n’importe quelle forme) de GHCR sur des dépôts <strong>publics</strong> est totalement gratuite Sur des dépôts privés : le pull via des actions est gratuit. Pour les actions <code>self-hosted</code> le pull est gratuit si l’action est authentifiée par le <code>GITHUB_TOKEN</code> et non un PAT.</p>
<p>Voici un exemple d’utilisation sans coût associé</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Run in container from GHCR</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain"> push </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">myJob</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">container</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ghcr.io/sedelpeuch/github</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">ghcr</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">test</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">master</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Checkout code</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Run a command</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "Running inside the container"</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>L’image <a href="http://ghcr.io/sedelpeuch/github-ghcr-test:master" target="_blank" rel="noopener noreferrer">ghcr.io/sedelpeuch/github-ghcr-test<!-- -->:master</a> est privée, l’accès est possible sans donner de PAT grâce à l’authentification par jeton automatique qui possède la lecture des packages privés <a href="https://docs.github.com/fr/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token" target="_blank" rel="noopener noreferrer">https://docs.github.com/fr/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token</a></p>]]></content:encoded>
            <category>Containerization</category>
            <category>Registry</category>
            <category>GitHub</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Pratiques recommandées pour Docker]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices</guid>
            <pubDate>Fri, 30 Aug 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[L'adoption de Docker augmente constamment et beaucoup le connaissent, mais tout le monde n'utilise pas Docker selon les meilleures pratiques.]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisez-une-image-docker-officielle-et-vérifiée-comme-image-de-base-chaque-fois-disponible">Utilisez une image Docker officielle et vérifiée comme image de base, chaque fois disponible<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#utilisez-une-image-docker-officielle-et-v%C3%A9rifi%C3%A9e-comme-image-de-base-chaque-fois-disponible" class="hash-link" aria-label="Direct link to Utilisez une image Docker officielle et vérifiée comme image de base, chaque fois disponible" title="Direct link to Utilisez une image Docker officielle et vérifiée comme image de base, chaque fois disponible">​</a></h2>
<p>Disons que vous développez une application Node.js et que vous souhaitez la créer et l'exécuter en tant qu'image Docker.</p>
<p>Au lieu de prendre une image du système d'exploitation de base et d'installer Node.js, NPM et tous les autres outils dont vous avez besoin pour votre application, utilisez l'image de node officiel pour votre application.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisez-des-versions-dimage-docker-spécifiques">Utilisez des versions d'image docker spécifiques<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#utilisez-des-versions-dimage-docker-sp%C3%A9cifiques" class="hash-link" aria-label="Direct link to Utilisez des versions d'image docker spécifiques" title="Direct link to Utilisez des versions d'image docker spécifiques">​</a></h2>
<p>D'accord, nous avons donc sélectionné l'image de base, mais maintenant lorsque nous construisons notre image d'applications à partir de ce Dockerfile, il utilisera toujours la dernière balise de l'image de nœud.</p>
<p>Ainsi, au lieu d'une étiquette d'image aléatoire, vous souhaitez fixer la version, et tout comme vous déployez votre propre application avec une version spécifique, vous souhaitez utiliser l'image officielle avec une version spécifique.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utiliser-des-images-officielles-de-petite-taille">Utiliser des images officielles de petite taille<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#utiliser-des-images-officielles-de-petite-taille" class="hash-link" aria-label="Direct link to Utiliser des images officielles de petite taille" title="Direct link to Utiliser des images officielles de petite taille">​</a></h2>
<p>Lors du choix d'une image Node.js, vous verrez qu'il y a en fait plusieurs images officielles. Non seulement avec différents numéros de version mais aussi avec différentes distributions de systèmes d'exploitation:</p>
<ol>
<li>
<p>Taille de l'image : si l'image est basée sur une distribution de système d'exploitation à part entière comme Ubuntu ou Centos, vous aurez un tas d'outils déjà emballés dans l'image. Ainsi, la taille de l'image sera plus grande, mais vous n'avez pas besoin de la plupart de ces outils dans vos images d'application.</p>
</li>
<li>
<p>Problème de sécurité : avec de nombreux outils installés à l'intérieur, vous devez considérer l'aspect de sécurité. Parce que ces images de base contiennent généralement <a href="https://snyk.io/blog/openSourcesEcurity-2020Survey/" target="_blank" rel="noopener noreferrer">des centaines de vulnérabilités connues</a> et créent essentiellement une plus grande surface d'attaque à votre image d'application.</p>
</li>
</ol>
<p>Ainsi, la meilleure pratique ici serait de sélectionner une image avec une version spécifique basée sur une distribution plus maigre comme Alpine.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="optimiser-la-mise-en-cache-pour-les-couches-dimage-lors-de-la-construction-dune-image">Optimiser la mise en cache pour les couches d'image lors de la construction d'une image<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#optimiser-la-mise-en-cache-pour-les-couches-dimage-lors-de-la-construction-dune-image" class="hash-link" aria-label="Direct link to Optimiser la mise en cache pour les couches d'image lors de la construction d'une image" title="Direct link to Optimiser la mise en cache pour les couches d'image lors de la construction d'une image">​</a></h2>
<ol>
<li>Que sont les layer d'image? Une image Docker est construite sur la base d'un dockerfile.</li>
</ol>
<p>Et dans un dockerfile, chaque commande ou instruction crée un layer d'image.</p>
<p>Ainsi, lorsque nous utilisons une image de base d'alpine, il a déjà des layers, car il a déjà été construit en utilisant son propre dockerfile. Dans notre dockerfile, nous avons quelques autres commandes qui ajouteront chacune un nouveau layer à cette image.</p>
<p>Ainsi, lorsque vous reconstruisez votre image, si votre Dockerfile n'a pas changé, Docker n'utilisera que les layers en cache pour construire l'image.</p>
<p>Avantages des layers d'image en cache:</p>
<ul>
<li>Contruction d'image plus rapide</li>
<li>Push et pull plus rapides de nouvelles versions d'image: Si je pull une nouvelle version d'image de la même application et, disons, 2 nouveaux layers ont été ajoutées dans la nouvelle version: seule la nouvelle version des layers ajoutées seront téléchargées Les autres sont déjà mis en cache localement par Docker.</li>
</ul>
<p>Optimiser la mise en cache : une fois qu'un layer change, tous les layers suivants doivent également être recréées. En d'autres termes: lorsque vous modifiez le contenu d'une ligne dans le dockerfile, les caches de toutes les lignes ou layers suivantes seront invalidés.</p>
<p>Ainsi, la règle ici et la meilleure pratique est: placez vos commandes dans le Dockerfile du moins au plus fréquemment modifé.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="à-laide-dun-fichier-dockerignore">à l'aide d'un fichier .dockerignore<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#%C3%A0-laide-dun-fichier-dockerignore" class="hash-link" aria-label="Direct link to à l'aide d'un fichier .dockerignore" title="Direct link to à l'aide d'un fichier .dockerignore">​</a></h2>
<p>C'est assez simple. Nous créons simplement ce fichier .dockerignore et répertorions tous les fichiers et dossiers que nous voulons être ignorés, et lors de la création de l'image, Docker examinera le contenu et ignorera tout ce qui est spécifié à l'intérieur.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisez-des-versions-multi-étages">Utilisez des versions multi-étages<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#utilisez-des-versions-multi-%C3%A9tages" class="hash-link" aria-label="Direct link to Utilisez des versions multi-étages" title="Direct link to Utilisez des versions multi-étages">​</a></h2>
<p>Maintenant, disons qu'il existe un outil dans votre projet dont vous avez besoin pour construire l'image mais vous n'en avez pas besoin dans l'image finale pour exécuter leapplication.</p>
<p>Supposons que vous conserviez ces artefacts dans votre image finale, même s'ils sont absolument inutiles pour exécuter l'application. Dans ce cas, cela entraînera à nouveau une augmentation de la taille de l'image et une augmentation de la surface d'attaque.</p>
<p>Pour cela, vous pouvez utiliser ce qu'on appelle les constructions à plusieurs étages</p>
<p>La fonction de construction en plusieurs étapes vous permet d'utiliser plusieurs images temporaires pendant le processus de construction, mais ne conserve que la dernière image comme artefact final.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="utilisez-lutilisateur-le-moins-privilégié">Utilisez l'utilisateur le moins privilégié<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#utilisez-lutilisateur-le-moins-privil%C3%A9gi%C3%A9" class="hash-link" aria-label="Direct link to Utilisez l'utilisateur le moins privilégié" title="Direct link to Utilisez l'utilisateur le moins privilégié">​</a></h2>
<p>Maintenant, lorsque nous créons cette image et que nous l'exécutons finalement en tant que conteneur, quel utilisateur du système d'exploitation sera utilisé pour démarrer l'application à l'intérieur? Par défaut, lorsqu'un DockerFile ne spécifie pas un utilisateur, il utilise un utilisateur root. Mais en réalité, il n'y a surtout aucune raison d'exécuter des conteneurs avec des privilèges root.</p>
<p>Cela introduit essentiellement un problème de sécurité car lorsque le conteneur commence sur l'hôte, il aura potentiellement un accès root sur l'hôte Docker.</p>
<p>Pour éviter cela, la meilleure pratique consiste à créer simplement un utilisateur dédié et un groupe dédié dans l'image Docker pour exécuter l'application et également exécuter l'application à l'intérieur du conteneur avec cet utilisateur.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scannez-vos-images-pour-les-vulnérabilités-de-sécurité">Scannez vos images pour les vulnérabilités de sécurité<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/30/03-containerization/docker-best-practices#scannez-vos-images-pour-les-vuln%C3%A9rabilit%C3%A9s-de-s%C3%A9curit%C3%A9" class="hash-link" aria-label="Direct link to Scannez vos images pour les vulnérabilités de sécurité" title="Direct link to Scannez vos images pour les vulnérabilités de sécurité">​</a></h2>
<p>Enfin, comment s'assurer et valider que l'image que vous construisez a peu ou pas de vulnérabilités de sécurité ?</p>
<p>La meilleure pratique est, une fois que vous avez construit l'image, la scannez pour des vulnérabilités de sécurité à l'aide de la commande docker scan.</p>
<p>En arrière-plan, Docker utilise en fait un service appelé SNYK pour faire la numérisation de la vulnérabilité des images. Le scan utilise une base de données de vulnérabilités, qui est constamment mise à jour.</p>]]></content:encoded>
            <category>Containerization</category>
            <category>Docker</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Débogage des conteneurs Docker]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers</guid>
            <pubDate>Thu, 15 Aug 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Guide pour déboguer les conteneurs Docker en utilisant des commandes de base et des options avancées.]]></description>
            <content:encoded><![CDATA[<p>Le débogage des conteneurs Docker est une compétence essentielle pour tout développeur ou administrateur système travaillant avec des environnements conteneurisés. Docker offre une variété de commandes et d'options pour aider à identifier et résoudre les problèmes qui peuvent survenir dans les conteneurs. Dans cet article, nous allons explorer certaines des commandes de base et des techniques avancées pour déboguer les conteneurs Docker.</p>
<p>&lt; !--truncate--&gt;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="commandes-de-base-pour-le-débogage">Commandes de base pour le débogage<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#commandes-de-base-pour-le-d%C3%A9bogage" class="hash-link" aria-label="Direct link to Commandes de base pour le débogage" title="Direct link to Commandes de base pour le débogage">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-ps">docker ps<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#docker-ps" class="hash-link" aria-label="Direct link to docker ps" title="Direct link to docker ps">​</a></h3>
<p>La commande <code>docker ps</code> est utilisée pour lister les conteneurs en cours d'exécution. Vous pouvez utiliser l'option <code>-a</code> pour afficher tous les conteneurs, qu'ils soient en cours d'exécution ou arrêtés.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">ps</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">ps</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-a</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-logs">docker logs<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#docker-logs" class="hash-link" aria-label="Direct link to docker logs" title="Direct link to docker logs">​</a></h3>
<p>La commande <code>docker logs</code> permet de visualiser les journaux d'un conteneur. Cela peut être très utile pour identifier les erreurs ou les comportements inattendus.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> logs </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">container_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Vous pouvez également utiliser le nom du conteneur à la place de l'ID.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-exec">docker exec<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#docker-exec" class="hash-link" aria-label="Direct link to docker exec" title="Direct link to docker exec">​</a></h3>
<p>La commande <code>docker exec</code> permet d'exécuter des commandes à l'intérieur d'un conteneur en cours d'exécution. Cela peut être utile pour naviguer dans le système de fichiers du conteneur, vérifier les configurations ou exécuter des scripts de diagnostic.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">exec</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-it</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">container_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> /bin/bash</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-inspect">docker inspect<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#docker-inspect" class="hash-link" aria-label="Direct link to docker inspect" title="Direct link to docker inspect">​</a></h3>
<p>La commande <code>docker inspect</code> fournit des informations détaillées sur un conteneur ou une image Docker. Cela inclut des détails sur la configuration, les réseaux, les volumes et plus encore.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> inspect </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">container_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="techniques-avancées-de-débogage">Techniques avancées de débogage<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#techniques-avanc%C3%A9es-de-d%C3%A9bogage" class="hash-link" aria-label="Direct link to Techniques avancées de débogage" title="Direct link to Techniques avancées de débogage">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="utilisation-de-docker-run-avec-des-options">Utilisation de docker run avec des options<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#utilisation-de-docker-run-avec-des-options" class="hash-link" aria-label="Direct link to Utilisation de docker run avec des options" title="Direct link to Utilisation de docker run avec des options">​</a></h3>
<p>La commande <code>docker run</code> peut être utilisée avec diverses options pour faciliter le débogage. Par exemple, l'option <code>-d</code> permet de démarrer un conteneur en mode détaché, tandis que l'option <code>-p</code> permet de mapper les ports entre l'hôte et le conteneur.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-d</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-p</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">8080</span><span class="token plain">:80 </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">image_name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redémarrage-des-conteneurs">Redémarrage des conteneurs<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#red%C3%A9marrage-des-conteneurs" class="hash-link" aria-label="Direct link to Redémarrage des conteneurs" title="Direct link to Redémarrage des conteneurs">​</a></h3>
<p>Les commandes <code>docker start</code> et <code>docker stop</code> permettent de redémarrer les conteneurs. Cela peut être utile si vous avez apporté des modifications à la configuration du conteneur et que vous souhaitez les appliquer.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> stop </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">container_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> start </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">container_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nommage-des-conteneurs">Nommage des conteneurs<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#nommage-des-conteneurs" class="hash-link" aria-label="Direct link to Nommage des conteneurs" title="Direct link to Nommage des conteneurs">​</a></h3>
<p>Lorsque vous créez un conteneur, vous pouvez lui attribuer un nom pour faciliter son identification. Cela peut être fait en utilisant l'option <code>--name</code> avec la commande <code>docker run</code>.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--name</span><span class="token plain"> my_container </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">image_name</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/08/15/03-containerization/debugging-docker-containers#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Le débogage des conteneurs Docker peut sembler complexe au début, mais en utilisant les commandes et techniques appropriées, vous pouvez rapidement identifier et résoudre les problèmes. Les commandes de base comme <code>docker ps</code>, <code>docker logs</code>, <code>docker exec</code> et <code>docker inspect</code> sont essentielles pour tout développeur ou administrateur système travaillant avec Docker. En combinant ces commandes avec des techniques avancées comme l'utilisation de <code>docker run</code> avec des options et le redémarrage des conteneurs, vous pouvez améliorer considérablement votre efficacité dans le débogage des conteneurs Docker.</p>]]></content:encoded>
            <category>Docker</category>
            <category>Debugging</category>
            <category>Containers</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Les containers Docker]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers</guid>
            <pubDate>Tue, 30 Jul 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Présentation des conteneurs Docker, leur fonctionnement et des exemples d'utilisation.]]></description>
            <content:encoded><![CDATA[<p>Les conteneurs Docker sont des unités logicielles légères et portables qui encapsulent une application et ses dépendances dans une image. Ces images sont composées de plusieurs couches, souvent basées sur une distribution Linux légère comme Alpine, pour minimiser la taille. Les conteneurs permettent de maintenir des applications isolées et cohérentes, indépendamment de l'environnement d'exécution.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-quun-conteneur-docker-">Qu'est-ce qu'un conteneur Docker ?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers#quest-ce-quun-conteneur-docker-" class="hash-link" aria-label="Direct link to Qu'est-ce qu'un conteneur Docker ?" title="Direct link to Qu'est-ce qu'un conteneur Docker ?">​</a></h2>
<p>Un conteneur Docker est une unité logicielle légère et portable qui encapsule une application et ses dépendances dans une image. Ces images sont composées de plusieurs couches, souvent basées sur une distribution Linux légère comme Alpine, pour minimiser la taille. Les conteneurs permettent de maintenir des applications isolées et cohérentes, indépendamment de l'environnement d'exécution.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="structure-dun-conteneur-docker">Structure d'un conteneur Docker<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers#structure-dun-conteneur-docker" class="hash-link" aria-label="Direct link to Structure d'un conteneur Docker" title="Direct link to Structure d'un conteneur Docker">​</a></h3>
<p>Un conteneur Docker est composé de plusieurs couches d'images empilées les unes sur les autres. À la base de la plupart des conteneurs, on trouve une image Linux, souvent Alpine en raison de sa petite taille. Les couches supérieures contiennent les dépendances et l'application elle-même. Cette structure en couches permet de réutiliser les couches communes entre plusieurs conteneurs, réduisant ainsi la taille et le temps de téléchargement.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="différence-entre-une-image-docker-et-un-conteneur-docker">Différence entre une image Docker et un conteneur Docker<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers#diff%C3%A9rence-entre-une-image-docker-et-un-conteneur-docker" class="hash-link" aria-label="Direct link to Différence entre une image Docker et un conteneur Docker" title="Direct link to Différence entre une image Docker et un conteneur Docker">​</a></h3>
<p>Une image Docker est un package statique qui contient tout ce dont une application a besoin pour fonctionner : le code, les bibliothèques, les dépendances et les configurations. C'est un modèle prêt à être exécuté. En revanche, un conteneur Docker est une instance en cours d'exécution de cette image. Lorsque vous démarrez un conteneur, Docker utilise l'image pour créer un environnement isolé où l'application peut s'exécuter. En d'autres termes, une image est un modèle, tandis qu'un conteneur est une instance active de ce modèle.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="commandes-docker-de-base">Commandes Docker de base<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers#commandes-docker-de-base" class="hash-link" aria-label="Direct link to Commandes Docker de base" title="Direct link to Commandes Docker de base">​</a></h2>
<p>Voici quelques commandes Docker de base pour gérer les conteneurs :</p>
<ul>
<li><code>docker run</code> : Cette commande permet de créer et de démarrer un conteneur à partir d'une image Docker. Par exemple, <code>docker run redis</code> démarre un conteneur Redis.</li>
<li><code>docker ps</code> : Cette commande affiche la liste des conteneurs en cours d'exécution. Par exemple, <code>docker ps</code> montre tous les conteneurs actifs.</li>
<li><code>docker stop</code> : Cette commande arrête un conteneur en cours d'exécution. Par exemple, <code>docker stop &lt;container_id&gt;</code> arrête le conteneur spécifié.</li>
<li><code>docker start</code> : Cette commande redémarre un conteneur arrêté. Par exemple, <code>docker start &lt;container_id&gt;</code> redémarre le conteneur spécifié.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-pratique--utilisation-de-postgresql-avec-docker">Exemple pratique : Utilisation de PostgreSQL avec Docker<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/30/03-containerization/docker-containers#exemple-pratique--utilisation-de-postgresql-avec-docker" class="hash-link" aria-label="Direct link to Exemple pratique : Utilisation de PostgreSQL avec Docker" title="Direct link to Exemple pratique : Utilisation de PostgreSQL avec Docker">​</a></h2>
<p>Pour illustrer l'utilisation des conteneurs Docker, prenons l'exemple de PostgreSQL. En utilisant Docker Hub, un dépôt public d'images Docker, on peut rechercher et télécharger une version spécifique de PostgreSQL. Par exemple, pour obtenir la version 9.6, il suffit d'exécuter la commande <code>docker pull</code> suivie de <code>docker run</code> pour démarrer le conteneur. Docker télécharge les couches nécessaires et démarre l'application automatiquement.</p>
<div class="language-bash codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-bash codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># Rechercher l'image officielle de PostgreSQL sur Docker Hub</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> search postgres</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Télécharger l'image de PostgreSQL version 9.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> pull postgres:9.6</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Démarrer un conteneur PostgreSQL avec la version 9.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--name</span><span class="token plain"> my-postgres </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-e</span><span class="token plain"> </span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">POSTGRES_PASSWORD</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">mysecretpassword </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-d</span><span class="token plain"> postgres:9.6</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>Docker</category>
            <category>Containerization</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Le concept containerisation (Docker)]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker</guid>
            <pubDate>Mon, 15 Jul 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Docker est un outil open source qui permet aux développeurs de créer, déployer, exécuter, mettre à jour et gérer les conteneurs.]]></description>
            <content:encoded><![CDATA[<p>Docker est de plus en plus populaire car il résout des problèmes courants dans le développement logiciel, en particulier ceux liés à la configuration de l'environnement et à la compatibilité. Les applications modernes utilisent souvent une combinaison de différentes technologies, chacune avec des dépendances de version spécifiques. Ces applications doivent fonctionner de manière cohérente dans divers environnements (développement, test, production), qui peuvent différer en termes de système d'exploitation, de version et de matériel. Sans Docker, chaque environnement doit être configuré avec les versions correctes des services, ce qui entraîne des problèmes de compatibilité et des configurations complexes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quest-ce-quun-conteneur-et-quels-problèmes-résout-il">Qu'est-ce qu'un conteneur et quels problèmes résout-il?<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker#quest-ce-quun-conteneur-et-quels-probl%C3%A8mes-r%C3%A9sout-il" class="hash-link" aria-label="Direct link to Qu'est-ce qu'un conteneur et quels problèmes résout-il?" title="Direct link to Qu'est-ce qu'un conteneur et quels problèmes résout-il?">​</a></h2>
<p>Un conteneur est un <strong>moyen de packager des applications</strong> avec tout ce dont ils ont besoin à l'intérieur de ce package, y compris toutes ses dépendances et toutes les configurations nécessaires.</p>
<p>Le package est portable comme tout autre artefact, et ce package peut être facilement partagé et déplacé entre une équipe de développement ou une équipe de développement et d'opérations.</p>
<p>La portabilité des conteneurs, ainsi que tout ce qui est packagé dans un <strong>environnement isolé</strong>, lui donne des avantages qui rendent le processus de développement et de déploiement plus efficace.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problèmes-résolus-par-docker">Problèmes résolus par Docker<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker#probl%C3%A8mes-r%C3%A9solus-par-docker" class="hash-link" aria-label="Direct link to Problèmes résolus par Docker" title="Direct link to Problèmes résolus par Docker">​</a></h3>
<p>Docker est de plus en plus populaire car il résout des problèmes courants dans le développement logiciel, en particulier ceux liés à la configuration de l'environnement et à la compatibilité. Les applications modernes utilisent souvent une combinaison de différentes technologies, chacune avec des dépendances de version spécifiques. Ces applications doivent fonctionner de manière cohérente dans divers environnements (développement, test, production), qui peuvent différer en termes de système d'exploitation, de version et de matériel. Sans Docker, chaque environnement doit être configuré avec les versions correctes des services, ce qui entraîne des problèmes de compatibilité et des configurations complexes.</p>
<p>Les principaux problèmes que Docker résout incluent :</p>
<ol>
<li>La compatibilité des services avec le système d'exploitation sous-jacent et ses bibliothèques.</li>
<li>La gestion des différentes versions des services et de leurs dépendances.</li>
<li>La simplification du processus de configuration pour les nouveaux développeurs.</li>
</ol>
<p>La solution de Docker consiste à regrouper chaque service avec ses dépendances système requises dans des conteneurs isolés. Cela permet de changer des composants sans affecter les autres services et de modifier le système d'exploitation sous-jacent sans impacter les services. Docker garantit que les applications fonctionnent de manière cohérente dans différents environnements, évitant ainsi le problème du "ça fonctionne sur ma machine".</p>
<p>De plus, Docker fournit des images prêtes à l'emploi pour divers environnements dans son dépôt officiel, ce qui facilite la configuration et l'exécution des services localement pour les développeurs. Par exemple, les développeurs peuvent récupérer une version spécifique d'une image de base de données Postgres et l'exécuter avec une seule commande. Cette flexibilité s'étend à l'exécution de plusieurs versions du même service pour différentes applications.</p>
<p>En résumé, Docker simplifie la configuration des environnements, assure la compatibilité et offre une flexibilité dans la gestion des services et de leurs dépendances.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="développement-dapplications-avant--après-conteneur">Développement d'applications avant / après conteneur<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker#d%C3%A9veloppement-dapplications-avant--apr%C3%A8s-conteneur" class="hash-link" aria-label="Direct link to Développement d'applications avant / après conteneur" title="Direct link to Développement d'applications avant / après conteneur">​</a></h2>
<p>Voyons maintenant comment les conteneurs améliorent le processus de développement par des exemples spécifiques.</p>
<p>Comment avons-nous développé des applications avant les conteneurs?</p>
<p>Habituellement, lorsque vous avez une équipe de développeurs travaillant sur une application, vous devez installer directement la plupart des services sur votre système d'exploitation.</p>
<p>Chaque développeur de l'équipe devrait alors aller installer les binaires de ces services, les configurer et les exécuter sur son environnement de développement local. Le processus d'installation sera différent en fonction du système d'exploitation qu'ils utilisent.</p>
<p>Vous avez donc quelques commandes à exécuter, et les <strong>chances qu'une erreur se produise sont élevées</strong>, en raison du nombre d'étapes nécessaires pour installer chaque service.</p>
<p>Maintenant, voyons comment les conteneurs résolvent certains de ces problèmes.</p>
<p>Vous n'avez pas à installer des services directement sur votre système d'exploitation, car le conteneur possède <strong>sa propre couche de système d'exploitation isolée</strong> avec une image de base Linux.</p>
<p>Vous avez tout packagé dans un environnement isolé, en tant que développeur, vous n'avez pas chercher les binaires à télécharger sur votre machine. Au lieu de cela, vous allez consulter le registre de conteneurs pour trouver le conteneur spécifique à votre application et le télécharger sur votre machine locale.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="déploiement-dapplication-avant--après-conteneur">Déploiement d'application avant / après conteneur<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker#d%C3%A9ploiement-dapplication-avant--apr%C3%A8s-conteneur" class="hash-link" aria-label="Direct link to Déploiement d'application avant / après conteneur" title="Direct link to Déploiement d'application avant / après conteneur">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="avant-les-conteneurs">Avant les conteneurs<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker#avant-les-conteneurs" class="hash-link" aria-label="Direct link to Avant les conteneurs" title="Direct link to Avant les conteneurs">​</a></h3>
<p>Un processus de déploiement traditionnel ressemblera à ceci:</p>
<p>L'équipe de développeur créera des artefacts, qui sont essentiellement des fichiers, ainsi que des instructions sur l'installation et les configurer sur le serveur. Tous ces artefacts et instructions seront fournis par l'équipe de développement:</p>
<p><img decoding="async" loading="lazy" alt="alt text" src="https://delpeuch.net/pr-preview/pr-15/assets/images/image-9b95c6cd8afa79d41610a7ff6b76f5f9.png" width="350" height="348" class="img_ev3q"></p>
<p>L'équipe de développement donnerait donc ces artefacts à l'équipe des opérations, et l'équipe d'opération mettrait en place les environnements pour déployer ces applications:</p>
<p><img decoding="async" loading="lazy" alt="Texte alt" src="https://delpeuch.net/pr-preview/pr-15/assets/images/image-1-fb8f11dc59bdcd139f7ea8afda840665.png" width="350" height="166" class="img_ev3q"></p>
<ul>
<li><strong>Dépendances externes sur le système d'exploitation du serveur</strong>: Le problème avec cette approche est que vous devez d'abord configurer tout et tout installer directement sur le système d'exploitation du serveur. Cela pourrait entraîner des conflits avec les versions de dépendance.</li>
<li><strong>Mauvaise communication</strong>: un autre problème qui pourrait résulter de ce processus est un malentendu entre l'équipe de développement et les opérations. Parce que tout est dans un guide textuel, il pourrait y avoir des cas, où les développeurs manquent de mentionner certains points critiques sur la configuration et en cas d'échec, l'équipe d'opérations doit retourner aux développeurs et demander plus de détails.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="avec-les-conteneurs">Avec les Conteneurs<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/07/15/03-containerization/docker#avec-les-conteneurs" class="hash-link" aria-label="Direct link to Avec les Conteneurs" title="Direct link to Avec les Conteneurs">​</a></h3>
<p>Avec les conteneurs, ce processus est simplifié, car maintenant les développeurs et les opérations fonctionnent dans une équipe pour former toutes les dépendances de configuration dans l'application.</p>
<p><img decoding="async" loading="lazy" alt="Texte alt" src="https://delpeuch.net/pr-preview/pr-15/assets/images/image-2-5c8a4648962758e750606cd1ae476ebd.png" width="529" height="256" class="img_ev3q"></p>
<p>Cela signifie que si vous utilisez un conteneur Docker, vous n'avez pas besoin de configurer quoi que ce soit directement sur le serveur, car tout est déjà encapsulé dans le conteneur. Au lieu de cela, il vous suffit d'exécuter une commande docker qui récupère le conteneur que vous avez stocké dans le registre, puis l'exécute.</p>
<p>C'est donc beaucoup plus simple et aucune configuration environnementale n'est nécessaire sur le serveur. La seule chose bien sûr est que vous devez installer et configurer le runtime docker sur le serveur avant de pouvoir y exécuter des conteneurs. Mais ce n'est qu'un effort unique.</p>]]></content:encoded>
            <category>Containerization</category>
            <category>Docker</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Architecture complète]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/06/11/04-ci-cd/exemple</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/06/11/04-ci-cd/exemple</guid>
            <pubDate>Tue, 11 Jun 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Exemple complet d'architecture CI/CD réutilisable]]></description>
            <content:encoded><![CDATA[<p>L'objectif est de créer une architecture CI/CD complète pour un projet de développement adressant une technologie (par exemple ROS). Cette architecture doit être :</p>
<ul>
<li>facilement réutilisable dans d'autres projets</li>
<li>éviter la duplication de code</li>
<li>maintenable et évolutive aisément</li>
<li>applicable à d'autres projets</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="création-dune-architecture-cicd">Création d'une architecture CI/CD<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/06/11/04-ci-cd/exemple#cr%C3%A9ation-dune-architecture-cicd" class="hash-link" aria-label="Direct link to Création d'une architecture CI/CD" title="Direct link to Création d'une architecture CI/CD">​</a></h2>
<p>L'idée de l'architecture est de créer un dépôt contenant tous les workflows et les actions propres à une technologie / projet (par exemple ROS). Ce dépôt sera ensuite utilisé comme cible pour les workflows des projets utilisant cette technologie.</p>
<!-- -->
<p>Dans cet exemple, nous avons un dépôt <code>ros_workflows</code> contenant les workflows et les actions propres à la technologie ROS. Ce dépôt est ensuite utilisé par les dépôts <code>ros_package_1</code>, <code>ros_package_2</code>, <code>ros_package_n</code> pour exécuter les workflows. Les différents workflows présents dans <code>ros_workflows</code> sont les <strong>uniques</strong> points d'entrée pour les workflows des dépôts <code>ros_package_1</code>, <code>ros_package_2</code>, <code>ros_package_n</code>. Ainsi s'il est nécessaire de modifier un workflow, il suffit de le faire dans le dépôt <code>ros_workflows</code> et tous les dépôts utilisant ce workflow seront mis à jour.</p>
<p>De plus le dépôt <code>ros_workflows</code> peut définir des <code>actions-composites</code> pour éviter la duplication de code entre leurs propres workflows. Ces actions sont utilisées par les workflows du dépôt <code>ros_workflows</code> et par conséquent des dépôts <code>ros_package_1</code>, <code>ros_package_2</code>, <code>ros_package_n</code>. Elles peuvent aussi être appelées directement au besoin.</p>
<p>Finalemet, le dépôt <code>ros_workflows</code> peut aussi utiliser des workflows génériques (par exemple <code>pre-commit.yml</code>) pour automatiser des tâches communes à toutes les technologies.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-workflow-ros1yml">Exemple de workflow <code>ros1.yml</code><a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/06/11/04-ci-cd/exemple#exemple-de-workflow-ros1yml" class="hash-link" aria-label="Direct link to exemple-de-workflow-ros1yml" title="Direct link to exemple-de-workflow-ros1yml">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Build &amp; Test ROS Packages</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">workflow_call</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">inputs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">package-name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'The name of the ROS package to build and test.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">type</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">secrets</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">PAT</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'A GitHub Personal Access Token (PAT) used to import the private repository into the container.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">pre-commit</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> catie</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">aq/generic_workflows/.github/workflows/pre</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">commit.yaml@main</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">build_and_test_ros_package</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">hosted </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Use self-hosted runner</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">strategy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Define a matrix of ROS distributions and Docker images</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">include</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">docker_image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> osrf/ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">noetic</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">desktop</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">full</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ros_distribution</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> noetic</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">container</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Use the Docker image defined in the matrix</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> matrix.docker_image </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Setup ROS environment</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">tooling/setup</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">ros@v0.7</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required-ros-distributions</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> matrix.ros_distribution </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Build and test ROS</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">tooling/action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">ci@v0.2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">package-name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> inputs.package</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">name </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">target-ros1-distro</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> matrix.ros_distribution </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">import-token</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.PAT </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-workflow-ciyml">Exemple de workflow <code>ci.yml</code><a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/06/11/04-ci-cd/exemple#exemple-de-workflow-ciyml" class="hash-link" aria-label="Direct link to exemple-de-workflow-ciyml" title="Direct link to exemple-de-workflow-ciyml">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"ROS CI/CD"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">user</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">/ros_workflows/.github/workflows/ros.yml@main</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-daction-composite-ros_buildactionyml">Exemple d'action composite <code>ros_build/action.yml</code><a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/06/11/04-ci-cd/exemple#exemple-daction-composite-ros_buildactionyml" class="hash-link" aria-label="Direct link to exemple-daction-composite-ros_buildactionyml" title="Direct link to exemple-daction-composite-ros_buildactionyml">​</a></h3>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Build and Test ROS'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Build and test a ROS package'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">inputs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">package-name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'The name of the ROS package to build and test.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">type</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ros-distribution</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'The ROS distribution to use for building and testing.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">type</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">import-token</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'A GitHub Personal Access Token (PAT) used to import the private repository into the container.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">type</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">using</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"composite"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "Building and testing ROS package $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> inputs.package</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">name </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> for ROS $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> inputs.ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">distribution </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">."</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">shell</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> bash</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>CI/CD</category>
            <category>GitHub</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Action Runner Controller GitHub]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc</guid>
            <pubDate>Fri, 10 May 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Explication de l'installation et de l'utilisation de l'Action Runner Controller GitHub]]></description>
            <content:encoded><![CDATA[<p>Actions Runner Controller (ARC) est un opérateur de Kubernetes qui orchestre et gère les runners auto-hébergés pour les actions GitHub.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="github-arc">GitHub ARC<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#github-arc" class="hash-link" aria-label="Direct link to GitHub ARC" title="Direct link to GitHub ARC">​</a></h2>
<p>Les runners auto-hébergés offrent un contrôle total sur l'environnement d'exécution, permettant de personnaliser les configurations et d'optimiser les performances selon les besoins spécifiques. Ils sont également plus rentables à long terme, car ils n'entraînent pas de coûts supplémentaires liés à l'utilisation des ressources de GitHub. Cependant, ils nécessitent une maintenance régulière et une gestion de la sécurité pour garantir leur bon fonctionnement et leur protection contre les menaces potentielles. En revanche, GitHub Actions Runner Controller (ARC) est une solution évolutive gérée par GitHub, qui permet de gérer automatiquement les runners dans un environnement Kubernetes. ARC offre une gestion simplifiée et une mise à l'échelle automatique des runners en fonction des besoins, ce qui est idéal pour les grandes organisations avec des charges de travail variables. Cependant, l'utilisation de GitHub ARC peut entraîner des coûts plus élevés pour les déploiements à grande échelle, et les utilisateurs ont moins de contrôle sur l'environnement d'exécution par rapport aux runners auto-hébergés.</p>
<p>Avec ARC, il est possible de créer des ensembles de runners qui évoluent automatiquement en fonction du nombre de workflows exécutés dans votre dépôt, organisation ou entreprise.</p>
<p>Le diagramme suivant illustre l'architecture du mode Scaleset Runner Autoscaling d'Arc.</p>
<p><a href="https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners-with-actions-runner-controller/quickstart-for-actions-runner-controller" target="_blank" rel="noopener noreferrer">Documentation complète</a></p>
<p><img decoding="async" loading="lazy" alt="alt text" src="https://delpeuch.net/pr-preview/pr-15/assets/images/arc-f0e0447cc92a8d4f3224674d4da3736d.png" width="1440" height="729" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>Sur GitHub les ARC sont identifiés par leur nom d'installation. Il est important de choisir un nom unique pour chaque installation. De plus pour simplifier l'écriture des workflows il est consillé de gérer les runners par des groupes de runners. La clé <code>runs-on</code> des jobs des workflows doit être égale à un groupe de runners.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prérequis">Prérequis<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#pr%C3%A9requis" class="hash-link" aria-label="Direct link to Prérequis" title="Direct link to Prérequis">​</a></h2>
<p>Pour utiliser l'ARC, il est nécessaire de disposer des éléments suivants :</p>
<ul>
<li>Un cluster Kubernetes</li>
<li>Helm 3.0 ou version ultérieure</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation-rapide">Installation rapide<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#installation-rapide" class="hash-link" aria-label="Direct link to Installation rapide" title="Direct link to Installation rapide">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>La suite du guide permet de rapidement installer ARC. Les différents concepts et la configuration avancée ne sont pas abordés. Pour une installation plus complète, regarder la <a href="https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners-with-actions-runner-controller/quickstart-for-actions-runner-controller" target="_blank" rel="noopener noreferrer">documentation officielle</a>.</p></div></div>
<ul>
<li>Le pod de contrôle est en charge de la gestion des pods de runner. Il s'occupe de la création, de la mise à l'échelle et de la suppression des pods de runner.</li>
<li>Le pod de runner est dédié à l'exécution des workflows GitHub Actions. Il se compose de deux conteneurs : un conteneur DinD et un conteneur runner. Le conteneur DinD fournit un environnement d'exécution Docker pour le conteneur runner. Le conteneur runner est utilisé pour exécuter les workflows GitHub Actions.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>Pour lancer le pod de contrôle :</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">NAMESPACE</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token string" style="color:hsl(95, 38%, 62%)">"arc-systems"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">helm </span><span class="token function" style="color:hsl(207, 82%, 66%)">install</span><span class="token plain"> arc </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--namespace</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token string variable" style="color:hsl(207, 82%, 66%)">${NAMESPACE}</span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    --create-namespace </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set-controller</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour lancer le pod de runner :</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">INSTALLATION_NAME</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token string" style="color:hsl(95, 38%, 62%)">"elegantencoder"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token assign-left variable" style="color:hsl(207, 82%, 66%)">NAMESPACE</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token string" style="color:hsl(95, 38%, 62%)">"arc-runners"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">helm </span><span class="token function" style="color:hsl(207, 82%, 66%)">install</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token string variable" style="color:hsl(207, 82%, 66%)">${INSTALLATION_NAME}</span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--namespace</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token string variable" style="color:hsl(207, 82%, 66%)">${NAMESPACE}</span><span class="token string" style="color:hsl(95, 38%, 62%)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    --create-namespace </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-f</span><span class="token plain"> value.yaml </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    oci://ghcr.io/actions/actions-runner-controller-charts/gha-runner-scale-set</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">;</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="authentification">Authentification<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#authentification" class="hash-link" aria-label="Direct link to Authentification" title="Direct link to Authentification">​</a></h2>
<p>Pour que le pod de contrôle puisse créer des pods de runner, il faut lui donner les droits nécessaires. Pour cela, il faut créer un secret contenant un token d'authentification. Les différents éléments proviennent de l'enregistrement d'une application GitHub au niveau de l'organisation concernée.</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">kubectl create secret generic pre-defined-secret </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">   </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--namespace</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">arc-runners </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">   --from-literal</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">github_app_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">xxx </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">   --from-literal</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">github_app_installation_id</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">xxx </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">   --from-literal</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token plain">github_app_private_key</span><span class="token operator" style="color:hsl(207, 82%, 66%)">=</span><span class="token string" style="color:hsl(95, 38%, 62%)">'xxx'</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring">​</a></h2>
<p>Dashboard Helm</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">helm dashboard </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--bind</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">0.0</span><span class="token plain">.0.0</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Portainer</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-cache">Docker cache<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/05/10/04-ci-cd/github-arc#docker-cache" class="hash-link" aria-label="Direct link to Docker cache" title="Direct link to Docker cache">​</a></h2>
<p>Nous avons rencontré un problème de lenteur lors de la construction des images Docker. Pour y remédier, nous avons mis en place la mutualisation des couches des images Docker entre les différents pods et l'hôte. Cela implique la création d'un volume partagé entre les différents pods et l'hôte. Ces volumes sont montés dans le conteneur DinD du pod qui les utilise pour fournir les images Docker au conteneur du runner. Chaque pod de runner contient un conteneur DinD qui est utilisé pour construire les images Docker.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> overlay2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">hostPath</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> /var/lib/docker/overlay2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">overlay2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">hostPath</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> /var/lib/docker/image/overlay2</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>CI/CD</category>
            <category>GitHub</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Runner GitHub Self-Hosted]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/04/15/04-ci-cd/self-host-runner</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/04/15/04-ci-cd/self-host-runner</guid>
            <pubDate>Mon, 15 Apr 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Explication de la création et de l'installation d'un nouveau runner au niveau de l'organisation]]></description>
            <content:encoded><![CDATA[<p>Un <code>runner</code> est une machine virtuelle ou physique qui exécute des <code>jobs</code> dans un <code>workflow</code>. Les <code>runners</code> peuvent être hébergés par GitHub ou auto-hébergés. Les <code>runners</code> hébergés par GitHub sont exécutés dans un environnement de cloud partagé et sont gérés par GitHub et peuvent entrainer des surcouts. Les <code>runners</code> auto-hébergés sont exécutés sur une machine que vous possédez et gérez.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comparaison-entre-les-runners-auto-hébergés-et-les-runners-cloud-hébergés-de-github">Comparaison entre les runners auto-hébergés et les runners cloud-hébergés de GitHub<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/04/15/04-ci-cd/self-host-runner#comparaison-entre-les-runners-auto-h%C3%A9berg%C3%A9s-et-les-runners-cloud-h%C3%A9berg%C3%A9s-de-github" class="hash-link" aria-label="Direct link to Comparaison entre les runners auto-hébergés et les runners cloud-hébergés de GitHub" title="Direct link to Comparaison entre les runners auto-hébergés et les runners cloud-hébergés de GitHub">​</a></h2>
<p>Les runners auto-hébergés offrent un contrôle total sur l'environnement d'exécution, ce qui permet de personnaliser les configurations et d'optimiser les performances selon les besoins spécifiques. Ils sont également plus rentables à long terme, car ils n'entraînent pas de coûts supplémentaires liés à l'utilisation des ressources de GitHub. Cependant, ils nécessitent une maintenance régulière et une gestion de la sécurité pour garantir leur bon fonctionnement et leur protection contre les menaces potentielles.</p>
<p>Les runners cloud-hébergés de GitHub sont gérés par GitHub, ce qui signifie que les utilisateurs n'ont pas à se soucier de la maintenance, de la sécurité ou de la mise à jour des runners. Ils sont également facilement évolutifs, car GitHub peut ajouter des ressources supplémentaires en fonction des besoins. Cependant, les runners cloud-hébergés peuvent entraîner des coûts supplémentaires pour les utilisateurs, en particulier pour les projets de grande envergure ou les charges de travail intensives.</p>
<p>En résumé, les runners auto-hébergés sont idéaux pour les équipes ou les projets avec des besoins spécifiques en matière de configuration et de performances, tandis que les runners cloud-hébergés de GitHub sont mieux adaptés aux utilisateurs qui préfèrent une solution gérée et évolutive sans avoir à se soucier de la maintenance et de la sécurité. Le choix entre les deux dépend des besoins spécifiques de l'équipe et des ressources disponibles.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="créér-un-runner-auto-hébergés">Créér un runner auto-hébergés<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/04/15/04-ci-cd/self-host-runner#cr%C3%A9%C3%A9r-un-runner-auto-h%C3%A9berg%C3%A9s" class="hash-link" aria-label="Direct link to Créér un runner auto-hébergés" title="Direct link to Créér un runner auto-hébergés">​</a></h2>
<p>Pour télécharger un nouveau <code>runner</code>, exécutez les lignes suivantes</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># Create a folder</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">mkdir</span><span class="token plain"> actions-runner </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">cd</span><span class="token plain"> actions-runner</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Download the latest runner package</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-o</span><span class="token plain"> actions-runner-linux-x64-2.312.0.tar.gz </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-L</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">https://github.com/actions/runner/releases/download/v2.312.0/actions-runner-linux-x64-2.312.0.tar.gz</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># ! update this documentation with the latest release</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Optional: Validate the hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token builtin class-name" style="color:hsl(29, 54%, 61%)">echo</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"85c1bbd104d539f666a89edef70a18db2596df374a1b51670f2af1578ecbe031  actions-runner-linux-x64-2.312.0.tar.gz"</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">|</span><span class="token plain"> shasum </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-a</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">256</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-c</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Extract the installer</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">tar</span><span class="token plain"> xzf ./actions-runner-linux-x64-2.312.0.tar.gz</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Il est ensuite nécessaire de configurer votre <code>runner</code></p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token comment" style="color:hsl(220, 10%, 40%)"># Create the runner and start the configuration experience</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">./config.sh </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--url</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">https://github.com/</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">org</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain">/</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">repo</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">--token</span><span class="token plain"> </span><span class="token operator" style="color:hsl(207, 82%, 66%)">&lt;</span><span class="token plain">token</span><span class="token operator" style="color:hsl(207, 82%, 66%)">&gt;</span><span class="token comment" style="color:hsl(220, 10%, 40%)"># Last step, run it!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">./run.sh</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Le token est à obtenir au près d’un <code>owner</code> de l’organisation accessible sur le lien suivant <span style="display:inline-flex;gap:0.25rem"><span></span><a href="https://github.com/organizations/org/settings/actions/runners/new?arch=x64&amp;os=linux" target="_blank" rel="noopener noreferrer">https://github.com/organizations/</a></span></p></div></div>
<p>➡️ Lors de la configuration, il est possible d'ajouter des <strong>labels</strong> pour identifier la machine (par exemple <code>GPU</code>).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="créer-une-action-self-hosted">Créer une action <code>self-hosted</code><a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/04/15/04-ci-cd/self-host-runner#cr%C3%A9er-une-action-self-hosted" class="hash-link" aria-label="Direct link to créer-une-action-self-hosted" title="Direct link to créer-une-action-self-hosted">​</a></h2>
<p>Il n’est pas possible de créer une action visant une machine <code>self-hosted</code> particulière (à confirmer). Chaque <code>repository</code> d’une organisation peut accéder à :</p>
<ul>
<li>Toutes les machines dans le groupe <code>Défaut</code> qui sont automatiquement partagées à tous les dépôts.</li>
<li>Toutes les machines dans un groupe <code>Name</code> qui sont manuellement partagées au dépôt concerné (l’affectation manuelle des dépôts à des groupes de machines nous encourage à ne pas utiliser ceci sauf cas particulier)</li>
</ul>
<p>Parmi les machines disponibles le <code>repository</code> peut demander d’utiliser une machine en fonction de son <code>label</code> par exemple l’action ci-dessous, permettant de vérifier que le dépôt est compilable sous ROS, réquisitionne une machine ayant le label <code>Robotics</code>. Ceci est modifiable à la ligne <code>runs-on: Robotics</code>.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> CI</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">pull_request</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">industrial_ci</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">strategy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">env</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ROS_DISTRO</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> melodic</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">ROS_REPO</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> main</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Robotics</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v3</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'ros-industrial/industrial_ci@master'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">env</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain">matrix.env</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lors de la première utilisation, si vous rencontrez un erreur <code>docker</code> spécifiant un manque de permission, il est nécessaire de taper la commande suivante sur la machine distance <code>sudo setfacl --modify user:&lt;user&gt;:rw /var/run/docker.sock</code>
Lorsqu’une action est créé en <code>self-hosted</code> il est fortement conseillé de mettre les actions dans un <code>container</code>. Lorsque c’est impossible (comme <code>tailscale</code>) il est nécessaire d’ajouer un clean de l’environnement à la fin de l’action en ajoutant cette <code>step</code></p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Clean runner</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">if</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> always()</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> rm </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">rf $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> github.workspace </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">/*</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mettre-en-place-le-runner-sous-forme-de-service">Mettre en place le runner sous forme de service<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/04/15/04-ci-cd/self-host-runner#mettre-en-place-le-runner-sous-forme-de-service" class="hash-link" aria-label="Direct link to Mettre en place le runner sous forme de service" title="Direct link to Mettre en place le runner sous forme de service">​</a></h2>
<p>Dans le dossier de votre <code>runnner</code> sur la machine, transformer le <code>./run.sh</code> en service, tapez simplement les lignes ci-dessous pour que le <code>runner</code> s’active au démarrage de la machine.</p>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> ./svc.sh </span><span class="token function" style="color:hsl(207, 82%, 66%)">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token function" style="color:hsl(207, 82%, 66%)">sudo</span><span class="token plain"> ./svc.sh start</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content:encoded>
            <category>CI/CD</category>
            <category>GitHub</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Actions Composites]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action</guid>
            <pubDate>Thu, 28 Mar 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Crééer une action réutilisable]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-de-création-et-dutilisation-dune-action-github">Exemple de création et d'utilisation d'une action GitHub<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action#exemple-de-cr%C3%A9ation-et-dutilisation-dune-action-github" class="hash-link" aria-label="Direct link to Exemple de création et d'utilisation d'une action GitHub" title="Direct link to Exemple de création et d'utilisation d'une action GitHub">​</a></h2>
<p>Voici un exemple de création et d'utilisation d'une action GitHub pour automatiser le déploiement d'une application Node.js.</p>
<ol>
<li>Créez un fichier <code>action.yml</code> dans le répertoire <code>.github/actions/deploy</code> de votre dépôt avec le contenu suivant :</li>
</ol>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Deploy Node.js App'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Deploy a Node.js application to a remote server'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">inputs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">server</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'The remote server to deploy to'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">username</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'The username to use for the deployment'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">password</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'The password to use for the deployment'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">using</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'composite'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Checkout code</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Install dependencies</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> npm install</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Build application</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> npm run build</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Deploy application</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">|</span><span class="token scalar string" style="color:hsl(95, 38%, 62%)"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token scalar string" style="color:hsl(95, 38%, 62%)">        sshpass -p ${{ inputs.password }} ssh ${{ inputs.username }}@${{ inputs.server }} 'mkdir -p /var/www/myapp'</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token scalar string" style="color:hsl(95, 38%, 62%)">        sshpass -p ${{ inputs.password }} scp -r ./build/* ${{ inputs.username }}@${{ inputs.server }}:/var/www/myapp</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Créez un fichier <code>deploy.yml</code> dans le répertoire <code>.github/workflows</code> de votre dépôt avec le contenu suivant :</li>
</ol>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Deploy Node.js App</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">branches</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">deploy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Deploy application</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ./.github/actions/deploy</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">server</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.DEPLOY_SERVER </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">username</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.DEPLOY_USERNAME </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">password</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.DEPLOY_PASSWORD </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Dans cet exemple, l'action <code>Deploy Node.js App</code> est utilisée pour déployer une application Node.js sur un serveur distant. L'action est déclenchée à chaque fois qu'un push est effectué sur la branche <code>main</code>. Les informations de déploiement (serveur, nom d'utilisateur et mot de passe) sont stockées dans les secrets du dépôt pour des raisons de sécurité.</p>
<p>Les actions GitHub permettent d'automatiser, personnaliser et exécuter un flux de travail directement depuis votre dépôt. Avec les actions GitHub, il est possible de créer des tâches personnalisées pour automatiser un flux de travail, partager et découvrir des actions pour effectuer des tâches spécifiques.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="comment-créer-ses-propres-actions">Comment créer ses propres actions<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action#comment-cr%C3%A9er-ses-propres-actions" class="hash-link" aria-label="Direct link to Comment créer ses propres actions" title="Direct link to Comment créer ses propres actions">​</a></h2>
<p>Documentation complète : <a href="https://docs.github.com/fr/actions/creating-actions" target="_blank" rel="noopener noreferrer">https://docs.github.com/fr/actions/creating-actions</a></p>
<p>La création d'actions personnalisées offre la possibilité de concevoir du code spécifique qui interagit avec le dépôt selon les besoins. Ces actions peuvent s'intégrer aux API de GitHub ou à toute API tierce accessible publiquement. Par exemple, une action pourrait être configurée pour publier des modules npm, envoyer des alertes par SMS en cas de création de problèmes urgents, ou encore déployer du code prêt pour la production.
Ce guide expose les éléments fondamentaux requis pour la création et l'utilisation d'une action composite empaquetée.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Lors de la création de flux de travail et d'actions, il est impératif d'évaluer constamment la possibilité d'exécution d'une entrée non fiable provenant de sources potentiellement malveillantes. Certains contextes doivent être traités comme des entrées non fiables, car un attaquant pourrait insérer son propre contenu malveillant. Pour de plus amples informations, veuillez consulter la section « <a href="https://docs.github.com/fr/actions/security-guides/security-hardening-for-github-actions#understanding-the-risk-of-script-injections" target="_blank" rel="noopener noreferrer">Durcissement de la sécurité pour GitHub Actions</a> ».</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="création-dune-action">Création d’une action<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action#cr%C3%A9ation-dune-action" class="hash-link" aria-label="Direct link to Création d’une action" title="Direct link to Création d’une action">​</a></h2>
<p>Un dépôt doit être créé sur <a href="http://github.com/" target="_blank" rel="noopener noreferrer">GitHub.com</a>.</p>
<ul>
<li>Créez un nouveau dépôt sur <a href="http://github.com/" target="_blank" rel="noopener noreferrer">GitHub</a>, en choisissant n'importe quel nom de dépôt ou en utilisant l'exemple suivant : <code>hello-world-composite-action</code>. Les fichiers peuvent être ajoutés une fois que le projet est poussé sur GitHub. Pour plus d'informations, veuillez vous référer à la section <a href="https://docs.github.com/fr/repositories/creating-and-managing-repositories/creating-a-new-repository" target="_blank" rel="noopener noreferrer">Création d'un dépôt</a>.</li>
<li>Dans le dépôt <code>hello-world-composite-action</code>, créez un fichier nommé <code>goodbye.sh</code> et ajoutez le code <code>echo "Goodbye</code></li>
<li>Rendez <code>goodbye.sh</code> exécutable depuis votre terminal.</li>
<li>Dans le dépôt <code>hello-world-composite-action</code>, créez un fichier nommé <code>action.yml</code> et ajoutez le code suivant en exemple. Pour plus d'informations sur cette syntaxe, consultez la section <a href="https://docs.github.com/fr/actions/creating-actions/metadata-syntax-for-github-actions#runs-for-composite-actions" target="_blank" rel="noopener noreferrer">Syntaxe des métadonnées pour les actions GitHub</a> .</li>
</ul>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Hello World'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Greet someone'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">inputs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">who-to-greet</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">  </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># id of input</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Who to greet'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">default</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'World'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">outputs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">random-number</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Random number"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">value</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> steps.random</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">number</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">generator.outputs.random</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">number </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">using</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"composite"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo Hello $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> inputs.who</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">to</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">greet </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">.</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">shell</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> bash</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> random</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">number</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">generator</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "random</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">number=$(echo $RANDOM)" </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">&gt;</span><span class="token plain"> $GITHUB_OUTPUT</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">shell</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> bash</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "$</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> github.action_path </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">" </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">&gt;</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">&gt;</span><span class="token plain"> $GITHUB_PATH</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">shell</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> bash</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> goodbye.sh</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">shell</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> bash</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Ce fichier définit l'entrée <code>who-to-greet</code>, mappe le nombre généré aléatoirement à la variable de sortie <code>random-number</code>, ajoute le chemin d'accès de l'action au chemin d'accès du système de l'exécuteur (pour localiser le script <code>goodbye.sh</code> lors de l'exécution) et exécute le script .</li>
<li>Effectuez le commit de votre fichier <code>action.yml</code> depuis votre terminal.</li>
</ul>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> </span><span class="token function" style="color:hsl(207, 82%, 66%)">add</span><span class="token plain"> action.yml</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> commit </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-m</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Add action"</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> push</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Ajoutez une étiquette depuis votre terminal. Cet exemple utilise une étiquette nommée <code>v1</code>.</li>
</ul>
<div class="language-shell codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-shell codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> tag </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-a</span><span class="token plain"> </span><span class="token parameter variable" style="color:hsl(207, 82%, 66%)">-m</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">"Description of this release"</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token function" style="color:hsl(207, 82%, 66%)">git</span><span class="token plain"> push --follow-tags</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tester-laction-dans-un-workflow">Tester l’action dans un workflow<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action#tester-laction-dans-un-workflow" class="hash-link" aria-label="Direct link to Tester l’action dans un workflow" title="Direct link to Tester l’action dans un workflow">​</a></h2>
<p>Copiez le code de workflow dans un fichier <code>.github/workflows/main.yml</code> d'un autre dépôt</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">hello_world_job</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> A job to say hello</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">id</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> foo</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/hello</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">world</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">composite</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">              </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">who-to-greet</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'Mona the Octocat'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo random</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">number $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> steps.foo.outputs.random</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">number </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">shell</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> bash</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="action-dans-un-workflow-privé">Action dans un workflow privé<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/28/04-ci-cd/action#action-dans-un-workflow-priv%C3%A9" class="hash-link" aria-label="Direct link to Action dans un workflow privé" title="Direct link to Action dans un workflow privé">​</a></h2>
<p>Dans les paramètres des actions, il est nécessaire de la partager à l’organisation</p>
<p><img decoding="async" loading="lazy" alt="AllowAction" src="https://delpeuch.net/pr-preview/pr-15/assets/images/allow_action-bfc7861aa70e40d33daa3bd986fb4ec3.png" width="788" height="273" class="img_ev3q"></p>]]></content:encoded>
            <category>CI/CD</category>
            <category>GitHub</category>
            <category>Devops</category>
        </item>
        <item>
            <title><![CDATA[Workflows]]></title>
            <link>https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow</link>
            <guid>https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow</guid>
            <pubDate>Sun, 17 Mar 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[Crééer un workflow avec GitHub Actions]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="exemple-dintégration-des-actions-github-dans-les-workflows">Exemple d'intégration des actions GitHub dans les workflows<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#exemple-dint%C3%A9gration-des-actions-github-dans-les-workflows" class="hash-link" aria-label="Direct link to Exemple d'intégration des actions GitHub dans les workflows" title="Direct link to Exemple d'intégration des actions GitHub dans les workflows">​</a></h2>
<p>Voici un exemple d'intégration des actions GitHub dans un workflow pour automatiser le déploiement d'une application Node.js.</p>
<p>Un workflow est l'élément central de GitHub Actions. Il s'agit d'un processus automatisé composé de <code>jobs</code> et de <code>steps</code> qui s'exécutent sur des <code>runners</code>. Les workflows sont déclenchés par des événements, tels que des pushs, des pull requests, des forks, etc.</p>
<p>Pour créer un fichier de workflow, il faut créer un fichier <code>.yml</code> dans le dossier <code>.github/workflows</code> du dépôt. Un workflow est composé de <code>jobs</code> et de <code>steps</code>. Un <code>job</code> est une suite d'étapes qui s'exécutent sur le même runner, tandis qu'un <code>step</code> est une tâche individuelle qui peut s'exécuter dans un <code>job</code>. Chaque <code>job</code> est exécuté dans un environnement dédié défini par <a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#type-de-machine"><code>runs-on</code></a>.</p>
<div class="language-yml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> CI</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain"></span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">  </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">build</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/checkout@v2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Run a one</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">line script</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo Hello</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> world</span><span class="token tag" style="color:hsl(355, 65%, 65%)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Run a multi</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">line script</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">|</span><span class="token scalar string" style="color:hsl(95, 38%, 62%)"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token scalar string" style="color:hsl(95, 38%, 62%)">          echo Add other actions to build,</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token scalar string" style="color:hsl(95, 38%, 62%)">          echo test, and deploy your project.</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Documentation Complète  : <a href="https://docs.github.com/en/actions/learn-github-actions/introduction-to-github-actions" target="_blank" rel="noopener noreferrer">https://docs.github.com/en/actions/learn-github-actions/introduction-to-github-actions</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="déclenchement-des-actions">Déclenchement des actions<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#d%C3%A9clenchement-des-actions" class="hash-link" aria-label="Direct link to Déclenchement des actions" title="Direct link to Déclenchement des actions">​</a></h2>
<p>Les déclencheurs de workflow sont des événements qui entraînent l’exécution d’un workflow. La syntaxe dépend du niveau de précision</p>
<ul>
<li>Pour tout ce qui concerne un événement :</li>
</ul>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># pull_request, fork etc</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Pour plus de finesse sur l’événement :</li>
</ul>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">label</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># type d'event (push, fork, pull_request)</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">types</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> created </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># trigger à chaque fois qu'un label est créé</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">push</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">branches</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> main </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># tous les push sur la branche main</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Déclenchement manuel de l’opération (avec prise d’argument)</li>
</ul>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">workflow_dispatch</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">inputs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">          </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">test_mode</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">description</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(95, 38%, 62%)">'True or False'</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">required</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:hsl(220, 14%, 71%);font-weight:bold">true</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>La liste complète des déclencheurs est disponible dans la <a href="https://docs.github.com/fr/actions/using-workflows/events-that-trigger-workflows" target="_blank" rel="noopener noreferrer">Documentation Github</a></p>
<p>Une exécution de workflow est composée d’un ou de plusieurs <code>jobs</code>, qui s’exécutent en parallèle par défaut. Chaque job est constitué d’un <code>name</code> et d’au moins un <code>step</code> pour être exécutable et peut être configuré.
La documentation précise des job est disponible dans la <a href="https://docs.github.com/fr/actions/using-workflows/workflow-syntax-for-github-actions#jobs" target="_blank" rel="noopener noreferrer">Documentation Github</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="marketplace">Marketplace<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#marketplace" class="hash-link" aria-label="Direct link to Marketplace" title="Direct link to Marketplace">​</a></h2>
<p>Chaque <code>job</code> permet d’exécuter un script. Le script le plus basique est un simple <code>run</code> avec des commandes <code>bash</code> derrière. Cependant, il est possible de réutiliser des actions définies dans le marketplace. Par exemple le <code>steps</code> ci-dessous permet d’exécuter l’action <span style="display:inline-flex;gap:0.25rem"><span></span><a href="https://github.com/ros-tooling/action-ros-ci" target="_blank" rel="noopener noreferrer">https://github.com/ros-tooling/action-ros-ci</a></span>. Le mot clé <code>with</code> permet de passer des paramètres à l’action.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>Le marketplace permet de réutiliser des actions déjà définies par la communauté. Il est important de vérifier la source de l’action avant de l’utiliser.</p></div></div>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> build and test ROS 2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">tooling/action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">ros</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">ci@v0.2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">package-name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> github</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">test</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">target-ros2-distro</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> matrix.ros_distribution </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">import-token</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> secrets.GITHUB_TOKEN </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># token autogenerated par github</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="réutiliser-les-workflows-et-actions">Réutiliser les Workflows et Actions<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#r%C3%A9utiliser-les-workflows-et-actions" class="hash-link" aria-label="Direct link to Réutiliser les Workflows et Actions" title="Direct link to Réutiliser les Workflows et Actions">​</a></h2>
<p>Il est possible de réutiliser des <code>workflows</code> et des <code>actions</code> dans un workflow. Pour cela, il est possible de créer des <code>workflows</code> et des <code>actions</code> dans des fichiers séparés et de les appeler dans le workflow principal.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">workflow</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># réutilisation du workflow</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> path/to/your</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">workflow.yml@v1</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">action</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># réutilisation d'une action</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">container</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">      </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> path/to/your</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">action@v1</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://docs.github.com/en/actions/learn-github-actions/reusing-workflows" target="_blank" rel="noopener noreferrer">Documentation des wokflows réutilisables</a></p>
<p><a href="https://docs.github.com/en/actions/creating-actions/creating-a-composite-action" target="_blank" rel="noopener noreferrer">Documentation des actions réutilisables</a></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Lorsqu'un workflow est réutilisé il défini son propre environnement (runner, container, etc). De plus il n'est pas utilisable dans une <code>step</code>.</p><p>À l'inverse, une action est utilisable dans une <code>step</code> et fonctionne dans l'environnement du <code>job</code> qui l'appelle.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="type-de-machine">Type de machine<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#type-de-machine" class="hash-link" aria-label="Direct link to Type de machine" title="Direct link to Type de machine">​</a></h2>
<p>Utilisez <code>jobs.&lt;job_id&gt;.runs-on</code> pour définir le type de machine sur laquelle le travail doit être exécuté. La configuration prend en argument un <code>tag</code> défini pour les runners</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name-job</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># runner distant sur les serveur de Github</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">hosted </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># runner local</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "Hello World </span><span class="token tag" style="color:hsl(355, 65%, 65%)">!</span><span class="token plain">"</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Les <code>runners</code> distants fourni par Github consomment du temps pour l’organisation dans les limites de 2 000 minutes gratuites par mois. Il est préférable d’utiliser des <code>runners self hosted</code> (voir <a href="https://docs.github.com/fr/actions/hosting-your-own-runners/managing-self-hosted-runners/about-self-hosted-runners" target="_blank" rel="noopener noreferrer">https://docs.github.com/fr/actions/hosting-your-own-runners/managing-self-hosted-runners/about-self-hosted-runners</a>)</p>
<p>Le choix du <code>runner</code> se fait via les tags. Toutes les machines auto-hébergées partagent le tag <code>self-hosted</code> , le tag de leur système d’exploitation (<code>Linux</code>, <code>Windows</code>), leur architecture (<code>x64</code>) et des tags personnalisés par machine.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="container">Container<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#container" class="hash-link" aria-label="Direct link to Container" title="Direct link to Container">​</a></h2>
<p>L’utilisation d’un <code>container</code> permet de créer un nouveau conteneur permettant d’exécuter les étapes d’un travail dans un conteneur spécififé. Si vous ne définissez pas de <code>container</code>, toutes les étapes s’exécutent directement sur l’hôte spécifié par <code>runs-on</code> dans le cas d’une machine auto-hébergées, il n’y a donc accès qu’aux packages installés sur la machine. Un <code>container</code> est rattaché à un <code>job</code>.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name-job</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">runs-on</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> self</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">hosted</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">container</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">image</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain">jammy </span><span class="token comment" style="color:hsl(220, 10%, 40%)"># run job with ubuntu:jammy docker</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "Hello World </span><span class="token tag" style="color:hsl(355, 65%, 65%)">!</span><span class="token plain">"</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="strategy">Strategy<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#strategy" class="hash-link" aria-label="Direct link to Strategy" title="Direct link to Strategy">​</a></h2>
<p>L’utilisation de <code>strategy</code> permet créer automatiquement plusieurs exécutions de travaux basées sur des combinaisons de variables. Une stratégie de matrice est utile pour tester du code dans différentes versions d'un langage ou sur différents systèmes d'exploitation.
Par exemple</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token key atrule" style="color:hsl(29, 54%, 61%)">jobs</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">example_matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">strategy</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">matrix</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">version</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token number" style="color:hsl(29, 54%, 61%)">10</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">12</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(29, 54%, 61%)">14</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">os</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">[</span><span class="token plain">ubuntu</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">,</span><span class="token plain"> windows</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">latest</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">steps</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">            </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">run</span><span class="token plain"> </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> echo "$</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> matrix.version </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain"> $</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">{</span><span class="token plain"> matrix.os </span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">}</span><span class="token plain">"</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Un travail s’exécute pour chaque combinaison possible des variables. Dans cet exemple, le workflow exécute six travaux, un pour chaque combinaison des variables <code>os</code> et <code>version</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="artéfact">Artéfact<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#art%C3%A9fact" class="hash-link" aria-label="Direct link to Artéfact" title="Direct link to Artéfact">​</a></h2>
<p>Les artefacts permettent de conserver des données une fois un travail terminé et de les partager avec une autre action. Un artefact est un fichier ou une collection de fichiers générés pendant l’exécution d’un workflow. Cet exemple permet de stocker un fichier comme artefact.</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Archive code coverage results</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/upload</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">artifact@v3</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> code</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">coverage</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">report</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">path</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> output/test/code</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">coverage.html</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pour récupérer un artefact</p>
<div class="language-yaml codeBlockContainer_APcc theme-code-block" style="--prism-background-color:hsl(220, 13%, 18%);--prism-color:hsl(220, 14%, 71%)"><div class="codeBlockContent_m3Ux"><pre tabindex="0" class="prism-code language-yaml codeBlock_qGQc thin-scrollbar" style="background-color:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><code class="codeBlockLines_p187"><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain"> </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> Download math result for job 2</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">uses</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> actions/download</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">-</span><span class="token plain">artifact@v3</span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">    </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">with</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3)"><span class="token plain">        </span><span class="token key atrule" style="color:hsl(29, 54%, 61%)">name</span><span class="token punctuation" style="color:hsl(220, 14%, 71%)">:</span><span class="token plain"> homework</span><br></span></code></pre><div class="buttonGroup_6DOT"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_FhaS" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_phi_"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_FfTR"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="vrac">Vrac<a href="https://delpeuch.net/pr-preview/pr-15/blog/2024/03/17/04-ci-cd/workflow#vrac" class="hash-link" aria-label="Direct link to Vrac" title="Direct link to Vrac">​</a></h2>
<ul>
<li><code>needs</code> le job actuel ne commencera que quand le job mentionné sera terminé</li>
<li><code>if</code> condition de lancement du job</li>
<li><code>permission</code> permet d’augmenter les droits du <code>GITHUB_TOKEN</code> (voir <a href="https://docs.github.com/fr/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token" target="_blank" rel="noopener noreferrer">https://docs.github.com/fr/actions/security-guides/automatic-token-authentication#permissions-for-the-github_token</a>)</li>
<li><code>environnement</code> permet de définir des variables d’environnement</li>
</ul>]]></content:encoded>
            <category>CI/CD</category>
            <category>GitHub</category>
            <category>Devops</category>
        </item>
    </channel>
</rss>