"use strict";(self.webpackChunksedelpeuch_net=self.webpackChunksedelpeuch_net||[]).push([[7150],{46005(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var s=t(46447),r=t(74848),o=t(28453);const a={title:"AWS : Lambda",description:"D\xe9couverte d'AWS Lambda et d'une URL de fonction.",tags:["cloud","devops"]},i=void 0,l={authorsImageUrls:[]},d=[{value:"Cr\xe9er la fonction",id:"cr\xe9er-la-fonction",level:2},{value:"Exemple de handler",id:"exemple-de-handler",level:2},{value:"Invoquer la Function URL",id:"invoquer-la-function-url",level:2},{value:"V\xe9rifier les logs",id:"v\xe9rifier-les-logs",level:3},{value:"Alternatives et bonnes pratiques",id:"alternatives-et-bonnes-pratiques",level:2},{value:"Exemple cha\xeenage simple entre deux Lambdas",id:"exemple-cha\xeenage-simple-entre-deux-lambdas",level:2},{value:"Nettoyage",id:"nettoyage",level:2}];function c(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"AWS Lambda permet d'ex\xe9cuter du code sans g\xe9rer de serveurs. Ce document d\xe9crit le d\xe9ploiement d'une fonction qui restitue une page HTML via une Function URL, les m\xe9thodes de test applicables et les op\xe9rations de nettoyage des ressources associ\xe9es."}),"\n",(0,r.jsx)(n.p,{children:"AWS Lambda est un service d'ex\xe9cution serverless orient\xe9 \xe9v\xe9nements. Une fonction Lambda ex\xe9cute du code en r\xe9ponse \xe0 des d\xe9clencheurs (HTTP via Function URL ou API Gateway, \xe9v\xe9nements S3, messages SNS/SQS, EventBridge, etc.). Le mod\xe8le de facturation repose sur le temps d'ex\xe9cution et la m\xe9moire allou\xe9e : il n'y a pas de co\xfbt pour des serveurs continus, seules les invocations et la dur\xe9e d'ex\xe9cution sont factur\xe9es."}),"\n",(0,r.jsx)(n.p,{children:"L'ex\xe9cution se fait dans des environnements \xe9ph\xe9m\xe8res isol\xe9s ; le d\xe9marrage initial peut entra\xeener un \"cold start\" pour certains runtimes. Les fonctions disposent de limites configurables (m\xe9moire, timeout, taille du bundle) et peuvent utiliser des layers pour partager des d\xe9pendances. Les logs et m\xe9triques sont \xe9mis vers CloudWatch, et l'ex\xe9cution requiert un r\xf4le IAM avec permissions minimales (principle du least privilege) pour les actions n\xe9cessaires."}),"\n",(0,r.jsx)(n.p,{children:"Cas d'usage courants : backends HTTP l\xe9gers, transformations d'objets S3, t\xe2ches asynchrones, webhooks et prototypes rapides. Pour des charges statiques ou des assets lourds, l'utilisation de S3 + CloudFront reste pr\xe9f\xe9rable."}),"\n",(0,r.jsx)(n.h2,{id:"cr\xe9er-la-fonction",children:"Cr\xe9er la fonction"}),"\n",(0,r.jsx)(n.p,{children:"La cr\xe9ation de la fonction peut s'effectuer depuis la console AWS Lambda."}),"\n",(0,r.jsxs)(n.p,{children:["La fonction peut \xeatre configur\xe9e avec des valeurs simples, par exemple ",(0,r.jsx)(n.code,{children:"runtime"})," ",(0,r.jsx)(n.code,{children:"nodejs22.x"}),", ",(0,r.jsx)(n.code,{children:"architecture"})," ",(0,r.jsx)(n.code,{children:"x86_64"})," et un nommage tel que ",(0,r.jsx)(n.code,{children:"http-function-url-tutorial"}),". Le r\xf4le d'ex\xe9cution peut \xeatre cr\xe9\xe9 automatiquement et doit autoriser l'envoi de logs vers CloudWatch."]}),"\n",(0,r.jsxs)(n.p,{children:['Le plan "Getting started with Lambda HTTP" fournit un ',(0,r.jsx)(n.code,{children:"index.html"})," et un handler simple lisant ce fichier et renvoyant son contenu comme body HTML. La fonction traite une requ\xeate HTTP et retourne un document HTML."]}),"\n",(0,r.jsx)(n.h2,{id:"exemple-de-handler",children:"Exemple de handler"}),"\n",(0,r.jsxs)(n.p,{children:["Le handler renvoie simplement ",(0,r.jsx)(n.code,{children:"index.html"}),". Exemple (ESM) :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// index.mjs\nimport fs from 'node:fs';\n\nconst html = fs.readFileSync('index.html', 'utf8');\n\nexport async function handler(event, context) {\n    // `event` contient les donn\xe9es de la requ\xeate HTTP ou l'\xe9v\xe9nement d\xe9clencheur.\n    // `context` fournit des m\xe9tadonn\xe9es d'ex\xe9cution (requestId, timeout restant, etc.).\n    return {\n        statusCode: 200,\n        headers: { 'Content-Type': 'text/html' },\n        body: html,\n    };\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Le handler re\xe7oit deux param\xe8tres principaux : ",(0,r.jsx)(n.code,{children:"event"})," et ",(0,r.jsx)(n.code,{children:"context"}),". Pour une invocation HTTP, ",(0,r.jsx)(n.code,{children:"event"})," inclut la m\xe9thode, les en-t\xeates et le corps de la requ\xeate. Le param\xe8tre ",(0,r.jsx)(n.code,{children:"context"})," fournit des informations sur l'ex\xe9cution en cours (identifiant de la requ\xeate, temps restant avant timeout). Les messages envoy\xe9s via ",(0,r.jsx)(n.code,{children:"console.log"})," apparaissent automatiquement dans CloudWatch Logs."]}),"\n",(0,r.jsx)(n.p,{children:"Le d\xe9marrage initial d'un environnement d'ex\xe9cution peut entra\xeener un \"cold start\" qui augmente la latence pour la premi\xe8re invocation. Les cold starts sont plus perceptibles pour certains runtimes et lorsque la fonction a des d\xe9pendances lourdes. Les strat\xe9gies pour r\xe9duire l'impact comprennent le provisioned concurrency, le choix d'un runtime optimis\xe9 et la r\xe9duction de la taille du bundle."}),"\n",(0,r.jsx)(n.p,{children:"Les variables d'environnement permettent de param\xe9trer le comportement sans modifier le code. Les layers servent \xe0 partager des d\xe9pendances entre fonctions et \xe0 r\xe9duire la taille des packages d\xe9ploy\xe9s. Pour des fichiers statiques ou des assets volumineux, h\xe9berger les ressources sur S3 et servir via CloudFront est g\xe9n\xe9ralement plus performant que de les embarquer dans le package Lambda."}),"\n",(0,r.jsx)(n.h2,{id:"invoquer-la-function-url",children:"Invoquer la Function URL"}),"\n",(0,r.jsxs)(n.p,{children:["Pour v\xe9rifier le d\xe9ploiement, l'onglet Code affiche le handler et le fichier ",(0,r.jsx)(n.code,{children:"index.html"}),". L'ouverture de l'URL de Function (Configuration \u2192 Function URL) dans un navigateur d\xe9clenche l'invocation et retourne la page HTML."]}),"\n",(0,r.jsxs)(n.p,{children:["Le test en ligne de commande s'effectue avec la commande suivante (remplacer ",(0,r.jsx)(n.code,{children:"<FUNCTION_URL>"})," par l'URL fournie par la console) :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'curl -i "https://<FUNCTION_URL>"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"v\xe9rifier-les-logs",children:"V\xe9rifier les logs"}),"\n",(0,r.jsxs)(n.p,{children:["Les logs CloudWatch fournissent les informations de diagnostic et les traces d'ex\xe9cution. Les entr\xe9es ",(0,r.jsx)(n.code,{children:"START/END/REPORT"})," et les erreurs JavaScript y sont visibles. Pour suivre les logs en temps r\xe9el, utiliser :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws logs tail /aws/lambda/http-function-url-tutorial --follow --since 1h\n"})}),"\n",(0,r.jsx)(n.p,{children:"La CLI AWS permet \xe9galement d'invoquer la fonction directement sans passer par la Function URL :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws lambda invoke --function-name http-function-url-tutorial out.txt\n"})}),"\n",(0,r.jsxs)(n.p,{children:["La diff\xe9rence principale est l'endpoint : ",(0,r.jsx)(n.code,{children:"aws lambda invoke"})," appelle l'API Lambda en mode administr\xe9 et ne refl\xe8te pas le comportement exact d'une invocation HTTP via Function URL (en-t\xeates, codes de statut). Pour une Function URL configur\xe9e en ",(0,r.jsx)(n.code,{children:"AWS_IAM"}),", les requ\xeates HTTP doivent \xeatre sign\xe9es (SigV4) ; les SDK AWS g\xe8rent cette signature automatiquement."]}),"\n",(0,r.jsx)(n.h2,{id:"alternatives-et-bonnes-pratiques",children:"Alternatives et bonnes pratiques"}),"\n",(0,r.jsxs)(n.p,{children:["Pour un usage public statique, il est pr\xe9f\xe9rable d'h\xe9berger ",(0,r.jsx)(n.code,{children:"index.html"})," sur S3 et d'utiliser CloudFront. Pour s\xe9curiser l'acc\xe8s \xe0 une fonction, il est recommand\xe9 d'utiliser ",(0,r.jsx)(n.code,{children:"AWS_IAM"})," ou de placer un API Gateway avec des m\xe9canismes d'authentification. Pour la performance, pr\xe9compiler et bundler les assets et \xe9viter les lectures synchrones \xe0 chaque invocation."]}),"\n",(0,r.jsx)(n.h2,{id:"exemple-cha\xeenage-simple-entre-deux-lambdas",children:"Exemple cha\xeenage simple entre deux Lambdas"}),"\n",(0,r.jsxs)(n.p,{children:["Un cha\xeenage simple entre deux fonctions Lambda permet d'illustrer les concepts d'invocation et de permissions sans introduire d'infrastructure suppl\xe9mentaire. Dans cet exemple, la fonction ",(0,r.jsx)(n.em,{children:"producer"})," invoque de mani\xe8re asynchrone la fonction ",(0,r.jsx)(n.em,{children:"consumer"})," via l'API Lambda (",(0,r.jsx)(n.code,{children:"Invoke"})," avec ",(0,r.jsx)(n.code,{children:"InvocationType='Event'"}),")."]}),"\n",(0,r.jsx)(n.p,{children:"Extrait du producer (Python) :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import os, json, boto3\n\nlambda_client = boto3.client('lambda')\nCONSUMER = os.environ.get('CONSUMER_FUNCTION_NAME', 'lambda-consumer')\n\ndef handler(event, context):\n    payload = { 'message': 'Hello from producer', 'input': event }\n    lambda_client.invoke(\n        FunctionName=CONSUMER,\n        InvocationType='Event',\n        Payload=json.dumps(payload).encode()\n    )\n    return { 'statusCode': 202, 'body': json.dumps({'sent': True}) }\n"})}),"\n",(0,r.jsx)(n.p,{children:"Comportement attendu du consumer : consigner le payload re\xe7u dans les logs CloudWatch et ex\xe9cuter le traitement asynchrone. Pour une invocation asynchrone, la r\xe9ponse renvoy\xe9e par le consumer n'est pas retourn\xe9e au caller."}),"\n",(0,r.jsxs)(n.p,{children:["Permissions minimales : le r\xf4le d'ex\xe9cution de la fonction producer doit inclure l'action ",(0,r.jsx)(n.code,{children:"lambda:InvokeFunction"})," ciblant l'ARN de la fonction consumer (ex. ",(0,r.jsx)(n.code,{children:"arn:aws:lambda:REGION:ACCOUNT_ID:function:lambda-consumer"}),")."]}),"\n",(0,r.jsx)(n.p,{children:"Test rapide (CLI) :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws lambda invoke --function-name lambda-producer --payload '{}' /tmp/out.json\ncat /tmp/out.json\n# Consulter les logs du consumer dans CloudWatch pour v\xe9rifier la r\xe9ception\n"})}),"\n",(0,r.jsx)(n.p,{children:"Remarques pratiques :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"V\xe9rifier la taille du payload ; pour des objets volumineux, stocker sur S3 et transmettre un lien."}),"\n",(0,r.jsx)(n.li,{children:"Inclure des m\xe9tadonn\xe9es (horodatage, requestId) facilite le tra\xe7age entre producer et consumer."}),"\n",(0,r.jsx)(n.li,{children:"Pr\xe9voir l'idempotence c\xf4t\xe9 consumer si des duplications peuvent survenir."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Les fichiers d'exemple correspondants se trouvent dans ",(0,r.jsx)(n.code,{children:"examples/lambda-two/"})," du d\xe9p\xf4t."]}),"\n",(0,r.jsx)(n.h2,{id:"nettoyage",children:"Nettoyage"}),"\n",(0,r.jsx)(n.p,{children:"La suppression des ressources commence par la suppression de la Function URL si elle n'est pas n\xe9cessaire, puis par la suppression de la fonction :"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"aws lambda delete-function --function-name http-function-url-tutorial\n"})}),"\n",(0,r.jsx)(n.p,{children:"Apr\xe8s suppression de la fonction, supprimer le r\xf4le IAM si celui-ci n'est plus utilis\xe9."})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453(e,n,t){t.d(n,{R:()=>a,x:()=>i});var s=t(96540);const r={},o=s.createContext(r);function a(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:n},e.children)}},46447(e){e.exports=JSON.parse('{"permalink":"/blog/2026/02/21/05-cloud/lambda","source":"@site/blog/05-cloud/2026-02-21-lambda.md","title":"AWS : Lambda","description":"D\xe9couverte d\'AWS Lambda et d\'une URL de fonction.","date":"2026-02-21T00:00:00.000Z","tags":[{"inline":false,"label":"Cloud","permalink":"/blog/tags/cloud"},{"inline":false,"label":"DevOps","permalink":"/blog/tags/devops"}],"readingTime":5.16,"hasTruncateMarker":true,"authors":[],"frontMatter":{"title":"AWS : Lambda","description":"D\xe9couverte d\'AWS Lambda et d\'une URL de fonction.","tags":["cloud","devops"]},"unlisted":false,"prevItem":{"title":"AWS : CLI","permalink":"/blog/2026/02/21/05-cloud/aws-cli"},"nextItem":{"title":"AWS : Free Tier, EC2 et IAM","permalink":"/blog/2026/02/19/05-cloud/ec2"}}')}}]);