<!DOCTYPE html>
<html lang="en-Us"><head>
  <meta charset="utf-8">
  <title>Les signaux</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Semestre 7 de l&#39;ENSEIRB-MATEMECA">
  <meta name="author" content="Sébastien">
  <meta name="generator" content="Hugo 0.74.3" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://Sdelpeuch.github.io/plugins/bootstrap/bootstrap.min.css">
  
  <link rel="stylesheet" href="https://Sdelpeuch.github.io/plugins/Ionicons/css/ionicons.min.css">
  
  <link rel="stylesheet" href="https://Sdelpeuch.github.io/plugins/magnific-popup/magnific-popup.css">
  
  <link rel="stylesheet" href="https://Sdelpeuch.github.io/plugins/slick/slick.css">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://Sdelpeuch.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://Sdelpeuch.github.io/images/favicon.png" type="image/x-icon">
  <link rel="icon" href="https://Sdelpeuch.github.io/images/favicon.png" type="image/x-icon">

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->

<header class="navigation">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        
        <nav class="navbar">
          
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navigation">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">
              <img src="https://Sdelpeuch.github.io/images/telechargement.png" alt="Semestre 8" width="65px" class="img-responsive">
            </a>
          </div>
          
          <div class="collapse navbar-collapse" id="navigation">
            <ul class="nav navbar-nav navbar-right">
              
              
              <li><a href="/">Accueil</a></li>
              
              
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                  aria-expanded="false">Semestre 8 <span class="ion-ios-arrow-down"></span></a>
                <ul class="dropdown-menu">
                  
                  <li><a href="/semestre8/apptcp-ip">Applications TCP/IP</a></li>
                  
                  <li><a href="/semestre8/complex">Calculabilité</a></li>
                  
                  <li><a href="/semestre8/crypto">Cryptologie</a></li>
                  
                  <li><a href="/semestre8/ia">Intelligence artificielle</a></li>
                  
                  <li><a href="/semestre8/maker">Maker</a></li>
                  
                  <li><a href="/semestre8/qualite">Qualité</a></li>
                  
                  <li><a href="/semestre8/robotique">Robotique</a></li>
                  
                  <li><a href="/semestre8/se">Sys Exploitation</a></li>
                  
                  <li><a href="/semestre8/jeux">Théorie des jeux</a></li>
                  
                </ul>
              </li>
              
              
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                  aria-expanded="false">Semestre 7 <span class="ion-ios-arrow-down"></span></a>
                <ul class="dropdown-menu">
                  
                  <li><a href="/semestre7/compilation/">Compilation</a></li>
                  
                  <li><a href="/semestre7/gl">Génie Logiciel</a></li>
                  
                  <li><a href="/semestre7/poo">POO</a></li>
                  
                  <li><a href="/semestre7/cpp">Programmation C&#43;&#43;</a></li>
                  
                  <li><a href="/semestre7/quantique">Quantique</a></li>
                  
                  <li><a href="/semestre7/bdd">SGBD</a></li>
                  
                  <li><a href="/semestre7/prog_sys/">Système</a></li>
                  
                  <li><a href="/semestre7/tcp">TCP/IP</a></li>
                  
                </ul>
              </li>
              
              
              
              <li><a href="/semestre6/semestre_6">Semestre 6</a></li>
              
              
              
              <li><a href="/semestre5/semestre_5">Semestre 5</a></li>
              
              
              
              <li><a href="/contact">Contact</a></li>
              
              
              
              <li><a href="/cpbx">CPBx</a></li>
              
              

              
            </ul>
          </div>
        </nav>
      </div>
    </div>
  </div>
</header>

<section class="page-title bg-2" style="background-image: url('https://Sdelpeuch.github.io/images/banner/info.jpg');">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="block">
          <h1>Les signaux</h1>
          <p></p>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="page-wrapper">
	<div class="container">
		<div class="row">
			<div class="col-md-8">
				<div class="post post-single">
					<h2 class="post-title">Les signaux</h2>
					<div class="post-meta">
						<ul>
              <li><i class="ion-calendar"></i> November 24, 2020</li>
              
              
              
              
              
              
              <li><i class="ion-pricetags"></i> 
                
                <a href="/tags/programmation%20syst%c3%a8me">Programmation système</a>
								
              </li>
            </ul>
					</div>
					
					
					
					<div class="post-content post-excerpt">
						<p>Les signaux sont un mécanisme asynchrone de communication inter-processus.
Intuitivement, ils sont comparables à des sonneries, les différentes sonneries
indiquant des évènements différents. Les signaux sont envoyés à un ou plusieurs
processus. Ce signal est en général associé à un évènement. Peu portables entre
BSD et ATT, ils deviennent plus commodes à utiliser et portables avec la norme
POSIX qui utilise la notion utile de vecteur de signaux et qui fournit un
mécanisme de masquage automatique pendant les procédures de traitement (comme
BSD). Un signal est envoyé à un processus en utilisant l&rsquo;appel système</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">kill(<span style="color:#66d9ef">int</span> pid, <span style="color:#66d9ef">int</span> signal);
</code></pre></div><p><code>signal</code> est un numéro compris entre 1 et <code>NSIG</code> (défini dans <code>&lt;signal.h&gt;</code>) et
<code>pid</code> est le numéro du processus. Le processus visé reçoit le signal sous forme
d&rsquo;un drapeau positionné dans son bloc de contrôle. Le processus est interrompu
et réalise éventuellement un traitement de ce signal. On peut considérer les
signaux comme des interruptions logicielles, ils interrompent le flot normal
d&rsquo;un processus mais ne sont pas traités de façon synchrone comme les
interruptions matérielles.</p>
<h3 id="provenance-des-signaux">Provenance des signaux</h3>
<p>Certains signaux peuvent être lancés à partir d&rsquo;un terminal grâce aux caractères
spéciaux comme <code>intr, quit</code> dont la frappe est transformée en l&rsquo;envoi des
signaux <code>SIGINT</code> et <code>SIGQUIT</code>. D&rsquo;autres sont dûes à des causes internes au
processus, par exemple : <code>SIGEGV</code> qui est envoyé en cas d&rsquo;erreur d&rsquo;adressage,
<code>SIGFPE</code> division par zéro (Floating Point Exception). Enfin certains sont dûes
à des évènements comme la déconnexion de la ligne (le terminal) utilisé : si le
processus leader d&rsquo;un groupe de processus est déconnecté, il envoie à l&rsquo;ensemble
des processus de son groupe le signal <code>SIGHUP</code>.</p>
<h3 id="gestion-interne-des-signaux">Gestion interne des signaux</h3>
<p>C&rsquo;est dans le bloc de contrôle (BCP) de chaque processus que l&rsquo;on trouve la
table de gestion des signaux. Cette table contient pour chaque signal défini sur
la machine, une structure <code>sigvec</code> suivante :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">{
bit pendant;
<span style="color:#66d9ef">void</span>(<span style="color:#f92672">*</span>traitement)(<span style="color:#66d9ef">int</span>);
}
</code></pre></div><p>en BSD et POSIX, on a un champ supplémentaire : <code>bit masque;</code> Le drapeau
<code>pendant</code> indique que le processus a reçu un signal, mais n&rsquo;a pas encore eu
l&rsquo;occasion de prendre en compte ce signal.</p>
<h3 id="lenvoi-de-signaux--la-primitive-kill">L&rsquo;envoi de signaux : la primitive kill</h3>
<p>Il y a NSIG signaux sur une machine, déclarés dans le fichier
<code>/usr/include/signal.h</code>. La valeur de <code>pid</code> indique le <code>PID</code> du processus auquel
le signal est envoyé. Le paramètre <code>sig</code> est interprété comme un signal si <code>sig</code>
est entre 0 et <code>NSIG</code>, ou comme une demande d&rsquo;information si <code>sig=0</code>. Comme un
paramètre erroné sinon. La fonction <code>raise(int signal)</code> est un raccourci pour
<code>kill(getpid(),signal)</code>, le processus s&rsquo;envoie à lui-même un signal.</p>
<h2 id="la-gestion-simplifiée-avec-la-fonction-signal">La gestion simplifiée avec la fonction <code>signal</code></h2>
<p>La fonction <code>signal</code> permet de spécifier ou de connaître le comportement du
processus à la réception d&rsquo;un signal donné, il faut donner en paramètre à la
fonction la numéro du signal <code>sig</code> que l&rsquo;on veut détourner et la fonction de
traitement action à réaliser à la réception du signal.</p>
<h3 id="problèmes-de-la-gestion-de-signaux-att">Problèmes de la gestion de signaux ATT</h3>
<p>Les phénomènes suivants sont décrits comme des problèmes mais la norme POSIX
permet d&rsquo;en conserver certains, mais fournit aussi les moyens de les éviter.</p>
<ol>
<li>Un signal est reposition à sa valeur par défaut au début de son traitement</li>
<li>Certains appels systèmes peuvent être interrompus et dans ce cas la valeur de
retour de l&rsquo;appel système est -1. Il faudrait, pour réaliser correctement ,e
modèle d&rsquo;une interruption logicielle, relancer l&rsquo;appel système en fin de
traitement du signal.</li>
<li>Si un signal est ignoré par un processus endormi, celui-ci sera réveillé par
le système uniquement pour apprendre qu&rsquo;il ignore le signal et doit donc être
endormi de nouveau.</li>
</ol>
<h2 id="la-norme-posix">La norme POSIX</h2>
<p>La norme POSIX ne définit pas le comportement d&rsquo;interruption des appels
systèmes, il faut le spécifier dans la structure de traitement du signal.</p>
<p><strong>Les ensembles de signaux</strong> La norme POSIX introduit les ensembles de signaux :
ces ensembles de signaux permettent de dépasser la contrainte classique qui veut
que le nombre de signaux soit inférieur ou égal au nombre de bits des entiers de
la machine. D&rsquo;autre part, des fonctions de manipulation de ces ensembles sont
fournies et permettent de définir simplement des masques. Ces ensembles de
signaux sont du type <code>sigset_t</code> et sont manipulantes grâce aux fonctions
suivantes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sigemptyset</span>(sigset_t <span style="color:#f92672">*</span>ens) <span style="color:#75715e">//raz
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> sigfillset(sigset_t <span style="color:#f92672">*</span>ens) <span style="color:#f92672">//</span> ens <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>, ..., NSIG}
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sigaddset</span>(sigset_t <span style="color:#f92672">*</span>ens, <span style="color:#66d9ef">int</span> sig) <span style="color:#f92672">//</span> ens <span style="color:#f92672">=</span> ens <span style="color:#f92672">+</span> {sig}
<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sigdelset</span>(sigset_t <span style="color:#f92672">*</span>ens, <span style="color:#66d9ef">int</span> sig) <span style="color:#f92672">//</span> ens <span style="color:#f92672">=</span> ens <span style="color:#f92672">-</span> {sig}
</code></pre></div><p>Ces fonctions retournent -1 en cas d&rsquo;échec et 0 sinon.</p>
<h3 id="le-blocage-des-signaux">Le blocage des signaux</h3>
<p>La fonction suivante permet de manipuler le masque des signaux du processus</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;signal.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sigprocmask</span>(<span style="color:#66d9ef">int</span> op, <span style="color:#66d9ef">const</span> sigset_t <span style="color:#f92672">*</span>nouv, sigset_t <span style="color:#f92672">*</span>anc);
</code></pre></div><p>L&rsquo;opération op :</p>
<ul>
<li><code>SIG_SETMASK</code> affectation du nouveau masque, récupération de la valeur de
l&rsquo;ancien masque</li>
<li><code>SIG_BLOCK</code> union de deux ensembles <code>nouv</code> et <code>anc</code></li>
<li><code>SIG_UNBLOCK</code> soustraction <code>anc-nouv</code></li>
</ul>
<p>On peut savoir si un signal est <code>pendant</code> et donc <code>bloqué</code> grâce à la fonction
<code>int sigpending(sigset_t *ens);</code> qui retourne -1 en cas d&rsquo;échec et 0 sinon et
l&rsquo;ensemble des signaux pendants est stocké à l&rsquo;adresse <code>ens</code>.</p>
<h3 id="sigaction"><code>sigaction</code></h3>
<p>La structure <code>sigaction</code> décrit le comportement utilisé pour le traitement d&rsquo;un
signal</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">struct</span> sigaction{
    <span style="color:#66d9ef">void</span> (<span style="color:#f92672">*</span>sa_handler)();
    sigset_t sa_mask;
    <span style="color:#66d9ef">int</span> sa_flags;
}
</code></pre></div><ul>
<li><code>sa_handler</code> fonction de traitement</li>
<li><code>sa_mask</code> ensemble de signaux supplémentaires à bloquer pendant le traitement</li>
<li><code>sa_flags</code> différentes options</li>
</ul>
<p>Le position du comportement de réception d&rsquo;un signal se fait par la primitive
<code>sigaction</code>. L&rsquo;installation d&rsquo;une fonction de traitement du signal <code>SIGCHLD</code>
peut avoir pour effet d&rsquo;envoyer un signal au processus, ceci dans le cas où le
processus a des fils zombie, c&rsquo;est toujours le problème lié à ce signal qui n&rsquo;a
pas le même comportement que les autres signaux. Un handler positionné par
<code>sigaction</code> reste jusqu&rsquo;à ce qu&rsquo;un autre handler soit positionné, à la
différence des versions ATT où le handler par défaut est repositionné
automatiquement au début du traitement du signal.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;signal.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sigaction</span>(<span style="color:#66d9ef">int</span> sig,
              <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">struct</span> sigaction <span style="color:#f92672">*</span>paction,
              <span style="color:#66d9ef">struct</span> sigaction <span style="color:#f92672">*</span>paction_precedente);
</code></pre></div><p>Cette fonction réalise soit une demande d&rsquo;information. Si le pointeur <code>paction</code>
est null, on obtient la structure <code>sigaction</code> courante. Sinon c&rsquo;est une demande
de modification du comportement.</p>
<h3 id="lattente-dun-signal">L&rsquo;attente d&rsquo;un signal</h3>
<p>En plus de l&rsquo;appel <code>pause</code>, on trouve sous POSIX l&rsquo;appel <code>int sigsuspend(const sigset_t * ens);</code> qui permet de réaliser de façons <code>atomique</code> les actions
suivantes :</p>
<ul>
<li>l&rsquo;installation du masque de blocage défini par <code>ens</code></li>
<li>mise en attente de la réception d&rsquo;un signal non bloqué.</li>
</ul>

					</div>
					<div class="post-comments">
						
					</div>
				</div>
			</div>
      <div class="col-md-4">
        <aside class="sidebar">





































<div class="widget widget-latest-post">
    <h4 class="widget-title">Derniers cours</h4>
    
    <div class="media">
      <div class="media-body">
        <h4 class="media-heading"><a href="https://Sdelpeuch.github.io/assets/md/crypto/1/">Langages, problèmes et fonctions</a></h4>
        <h5>[Cryptologie]</h5>
        <p>Qu&rsquo;est-ce qu&rsquo;un cryptosystème sûr ? On …</p>
      </div>
    </div>
    
    <div class="media">
      <div class="media-body">
        <h4 class="media-heading"><a href="https://Sdelpeuch.github.io/assets/md/ia/1/"></a></h4>
        <h5>[IA]</h5>
        <p></p>
      </div>
    </div>
    
    <div class="media">
      <div class="media-body">
        <h4 class="media-heading"><a href="https://Sdelpeuch.github.io/assets/md/jeux/5/">Cours 5</a></h4>
        <h5>[Jeux]</h5>
        <p>Réalisation d&rsquo;un algorithme de complexité en …</p>
      </div>
    </div>
    
    <div class="media">
      <div class="media-body">
        <h4 class="media-heading"><a href="https://Sdelpeuch.github.io/assets/md/robotique/1/">Modélisation du problème</a></h4>
        <h5>[Robotique]</h5>
        <p>Définition du problème    On cherche à trouver le …</p>
      </div>
    </div>
    
    <div class="media">
      <div class="media-body">
        <h4 class="media-heading"><a href="https://Sdelpeuch.github.io/assets/md/jeux/4/">Cours 4</a></h4>
        <h5>[Jeux]</h5>
        <p>Nous avons vu la dernière fois qu&rsquo;un jeu est …</p>
      </div>
    </div>
    
    <div class="media">
      <div class="media-body">
        <h4 class="media-heading"><a href="https://Sdelpeuch.github.io/assets/md/jeux/3/">Cours 3</a></h4>
        <h5>[Jeux]</h5>
        <p>Comment modélise t on un jeu ? une arène ? etc …</p>
      </div>
    </div>
    
  </div>
</aside>


      </div>
		</div>
	</div>
</section>

<footer class="footer">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="footer-manu">
					<ul>
            
            <li><a href="https://Sdelpeuch.github.io/about">Semestre 7</a></li>
            
            <li><a href="https://Sdelpeuch.github.io/contact">Semestre 6</a></li>
            
            <li><a href="https://Sdelpeuch.github.io/project">Semestre 5</a></li>
            
            <li><a href="https://Sdelpeuch.github.io/cpbx">CPBx</a></li>
            
					</ul>
				</div>
				<p class="copyright">Copyright © 2020 <a href="https://themefisher.com">Themefisher</a> All Rights Reserved</p>
			</div>
		</div>
	</div>
</footer>



<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcABaamniA6OL5YvYSpB3pFMNrXwXnLwU&amp;libraries=places"></script>




<script src="https://Sdelpeuch.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://Sdelpeuch.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://Sdelpeuch.github.io/plugins/slick/slick.min.js"></script>

<script src="https://Sdelpeuch.github.io/plugins/magnific-popup/jquery.magnific-popup.min.js"></script>

<script src="https://Sdelpeuch.github.io/plugins/shuffle/shuffle.min.js"></script>

<script src="https://Sdelpeuch.github.io/plugins/google-map/gmap.js"></script>




<script src="https://Sdelpeuch.github.io/js/script.min.js"></script>







<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-main btn-solid-border">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>

</html>